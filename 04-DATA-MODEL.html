<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>04-DATA-MODEL</title>
  <style>
    /* Default styles provided by pandoc.
    ** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
    */
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
    <style>
    /* ========== FinThrive Theme Styles (Embedded) ========== */
/* Load Google Font */
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap');

body {
  font-family: 'Plus Jakarta Sans', sans-serif;
}
/* Typography Variables */
:root {
  /* Font Families */
  --font--headlines: 'Plus Jakarta Sans', sans-serif;
  --font--body-text: 'Plus Jakarta Sans', sans-serif;
  --font--accent: 'Plus Jakarta Sans', sans-serif;
  
  /* Font Weights */
  --weight--headlines: 500;
  --weight--body: normal;
  
  /* Display Sizes (Responsive) */
  --d-l: clamp(3.375rem, 4.464vi + 1.232rem, 5.250rem);
  --d-m: clamp(2.625rem, 5.060vi + 0.196rem, 4.750rem);
  --d-s: clamp(2.375rem, 2.381vi + 1.232rem, 3.375rem);
  --d-xs: clamp(2.375rem, 2.381vi + 1.232rem, 3.375rem);
  
  /* Heading Sizes (Responsive) */
  --h-xxl: clamp(2.375rem, 2.381vi + 1.232rem, 3.375rem);
  --h-xl: clamp(2.25rem, 0.893vi + 1.821rem, 2.625rem);
  --h-l: clamp(1.5rem, 1.786vi + 0.643rem, 2.250rem);
  --h-m: clamp(1.5rem, 0.595vi + 1.214rem, 1.750rem);
  --h-s: 1.3125rem;
  --h-xs: 1.125rem;
  
  /* Body Text Sizes */
  --b-l: clamp(1.25rem, 0.298vi + 1.107rem, 1.375rem);
  --b-m: 1.125rem;
  --b-s: 1.0rem;
  --b-xs: 0.875rem;
  
  /* Spacing Scale (Responsive) */
  --s-12: clamp(4.0rem, 20.238vi + -5.714rem, 12.500rem);
  --s-11: clamp(3.0rem, 16.667vi + -5.000rem, 10.000rem);
  --s-10: clamp(3.0rem, 11.905vi + -2.714rem, 8.000rem);
  --s-9: clamp(2.375rem, 8.631vi + -1.768rem, 6.000rem);
  --s-8: clamp(2.375rem, 3.869vi + 0.518rem, 4.000rem);
  --s-7: clamp(2.0rem, 2.381vi + 0.857rem, 3.000rem);
  --s-6: clamp(2.0rem, 0.595vi + 1.714rem, 2.250rem);
  --s-5: clamp(1.125rem, 0.893vi + 0.696rem, 1.500rem);
  --s-4: 1.125rem;
  --s-3: 0.75rem;
  --s-2: 0.5rem;
  --s-1: 0.25rem;
  --s-0: 0.0rem;
}

/* Light Mode Color Theme (Default) */
:root,
.light-mode {
  /* Primary Colors */
  --primary: #00E091;
  --primary--medium: #80F2C3;
  --primary--light: #C0F9E1;
  --primary--extra-light: #EBFBF7;
  --primary--dark: #005654;
  
  /* Secondary Colors */
  --secondary: #FF9B5C;
  --secondary--medium: #F87A3A;
  --secondary--light: #FFCA98;
  --secondary--extra-light: #fff2e5;
  --secondary--dark: #663E25;
  
  /* Tertiary Colors */
  --tertiary: #3E69FA;
  --tertiary--medium: #3356CC;
  --tertiary--light: #CAD6FF;
  --tertiary--dark: #13204D;
  
  /* Accent Color */
  --accent: #9efb21;
  
  /* Neutral Colors */
  --neutral--black: #005654;
  --neutral--dark: #005654;
  --neutral--medium-dark: #545757;
  --neutral--medium: #A8ABAB;
  --neutral--medium-light: #D4D6D6;
  --neutral--light: #F5F5F5;
  --neutral--white: #FFFFFF;
  
  /* Neutral Color Transparency Variants */
  --neutral--dark-80: rgba(0, 86, 84, 0.8);
  --neutral--dark-60: rgba(0, 86, 84, 0.6);
  --neutral--dark-40: rgba(0, 86, 84, 0.4);
  --neutral--dark-20: rgba(0, 86, 84, 0.2);
  --neutral--dark-10: rgba(0, 86, 84, 0.1);
  --neutral--white-80: rgba(255, 255, 255, 0.8);
  --neutral--white-60: rgba(255, 255, 255, 0.6);
  --neutral--white-40: rgba(255, 255, 255, 0.4);
  --neutral--white-20: rgba(255, 255, 255, 0.2);
  --neutral--white-10: rgba(255, 255, 255, 0.1);
  
  /* Card Styles */
  --card-border: var(--neutral--medium-light);
  --card-background-light: var(--neutral--white);
  --card-background-dark: var(--neutral--dark);
  --card-border-hover: var(--neutral--medium-dark);
  
  /* Input Styles */
  --input--border: var(--neutral--medium);
  --input--border-focused: var(--inline-links);
  --input--border-active: var(--neutral--medium-dark);
  --input--border-disabled: var(--neutral--medium-light);
  
  /* Text Colors */
  --headlines: #005654;
  --text: #005654;
  --text--80: rgba(0, 86, 84, 0.8);
  --text--60: rgba(0, 86, 84, 0.6);
  --text-input: #005654;
  
  /* UI Elements */
  --hr: var(--neutral--medium-light);
  
  /* Link Colors */
  --inline-links: #3254c8;
  --inline-links--hover: #7393FF;
  --inline-links--visited: #8C3EFA;
  --menu-links: #005654;
  --menu-links--hover: #00E091;
  --menu-links--active: #005654;
  
  /* Primary Button */
  --btn--primary-fg: var(--neutral--white);
  --btn--primary-fg-hover: var(--neutral--white);
  --btn--primary-bg: var(--primary);
  --btn--primary-bg-hover: var(--primary--medium);
  --btn--primary-stroke: var(--primary--dark);
  
  /* Secondary Button */
  --btn--secondary-fg: var(--neutral--white);
  --btn--secondary-fg-hover: var(--neutral--white);
  --btn--secondary-bg: var(--secondary);
  --btn--secondary-bg-hover: var(--secondary--medium);
  --btn--secondary-stroke: var(--neutral-dark);
  
  /* Tertiary Button */
  --btn--tertiary-fg: var(--neutral--white);
  --btn--tertiary-fg-hover: var(--neutral--white);
  --btn--tertiary-bg: var(--tertiary);
  --btn--tertiary-bg-hover: var(--tertiary--medium);
  --btn--tertiary-stroke: var(--neutral-dark);
  
  /* White Button */
  --btn--white-fg: var(--primary);
  --btn--white-fg-hover: var(--neutral--white);
  --btn--white-bg: var(--neutral--white);
  --btn--white-bg-hover: var(--primary);
  --btn--white-stroke: var(--neutral--white);
  
  color: var(--text);
}

/* Dark Mode Color Theme */
.dark-mode {
  /* Text Colors */
  --headlines: #FFFFFF;
  --text: #FFFFFF;
  --text-input: #FFFFFF;
  
  /* UI Elements */
  --hr: var(--neutral--medium-dark);
  
  /* Link Colors */
  --inline-links: #FFFFFF;
  --inline-links--hover: #70BAFE;
  --inline-links--visited: #FFFFFF;
  --menu-links: #FFFFFF;
  --menu-links--hover: #C0F9E1;
  --menu-links--active: #FFFFFF;
  
  /* Card Styles */
  --card-border: var(--neutral--white);
  --card-background-light: var(--neutral--light);
  --card-border-hover: var(--neutral--white);
  
  /* Button Strokes */
  --btn--primary-stroke: var(--neutral--white);
  --btn--secondary-stroke: var(--neutral--white);
  --btn--tertiary-stroke: var(--neutral--white);
  
  color: var(--text);
}

/* ========== Table Styles ========== */

table {
  width: 100%;
  border-collapse: collapse;
  margin: var(--s-5) 0;
  font-size: var(--b-s);
  font-family: var(--font--body-text);
  background-color: var(--neutral--white);
  border: 1px solid var(--neutral--medium-light);
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0, 86, 84, 0.08);
}

/* Table Header */
thead {
  background-color: var(--primary--extra-light);
}

thead tr {
  border-bottom: 2px solid var(--primary--medium);
}

th {
  padding: var(--s-3) var(--s-4);
  text-align: left;
  font-weight: var(--weight--headlines);
  color: var(--primary--dark);
  font-size: var(--b-s);
  letter-spacing: 0.02em;
  white-space: nowrap;
}

/* Table Body */
tbody tr {
  border-bottom: 1px solid var(--neutral--medium-light);
  transition: background-color 0.15s ease;
}

tbody tr:last-child {
  border-bottom: none;
}

/* Zebra Striping */
tbody tr:nth-child(even) {
  background-color: var(--neutral--light);
}

tbody tr:nth-child(odd) {
  background-color: var(--neutral--white);
}

/* Row Hover Effect */
tbody tr:hover {
  background-color: var(--primary--extra-light);
}

/* Table Cells */
td {
  padding: var(--s-3) var(--s-4);
  color: var(--text);
  vertical-align: top;
  line-height: 1.5;
}

/* Code in Table Cells */
td code,
th code {
  background-color: var(--neutral--light);
  padding: 0.15em 0.4em;
  border-radius: 4px;
  font-size: 0.9em;
  color: var(--tertiary--dark);
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
}

/* Bold text in first column */
td:first-child strong,
td strong {
  color: var(--primary--dark);
  font-weight: 600;
}

/* Column Groups - ensure proper column widths */
colgroup col {
  min-width: 80px;
}

/* Responsive Table Wrapper */
@media screen and (max-width: 768px) {
  table {
    display: block;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  
  th, td {
    min-width: 120px;
    padding: var(--s-2) var(--s-3);
    font-size: var(--b-xs);
  }
}

/* Dark Mode Table Styles */
.dark-mode table {
  background-color: var(--neutral--dark);
  border-color: var(--neutral--medium-dark);
}

.dark-mode thead {
  background-color: rgba(0, 224, 145, 0.15);
}

.dark-mode thead tr {
  border-bottom-color: var(--primary--medium);
}

.dark-mode th {
  color: var(--primary--medium);
}

.dark-mode tbody tr:nth-child(even) {
  background-color: rgba(255, 255, 255, 0.05);
}

.dark-mode tbody tr:nth-child(odd) {
  background-color: transparent;
}

.dark-mode tbody tr:hover {
  background-color: rgba(0, 224, 145, 0.1);
}

.dark-mode tbody tr {
  border-bottom-color: var(--neutral--medium-dark);
}

.dark-mode td {
  color: var(--text);
}

.dark-mode td code,
.dark-mode th code {
  background-color: rgba(255, 255, 255, 0.1);
  color: var(--primary--light);
}

/* ========== Additional Layout Styles ========== */

/* Body max-width and padding for readability */
body {
  max-width: 1200px;
  margin: 0 auto;
  padding: var(--s-6) var(--s-5);
  line-height: 1.6;
  background-color: var(--neutral--white);
}

/* Headings */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font--headlines);
  font-weight: var(--weight--headlines);
  color: var(--headlines);
  margin-top: var(--s-6);
  margin-bottom: var(--s-4);
  line-height: 1.3;
}

h1 {
  font-size: var(--h-xxl);
  color: var(--primary--dark);
  border-bottom: 3px solid var(--primary);
  padding-bottom: var(--s-3);
  margin-bottom: var(--s-5);
}

h2 {
  font-size: var(--h-xl);
  color: var(--primary--dark);
  border-bottom: 2px solid var(--primary--medium);
  padding-bottom: var(--s-2);
}

h3 {
  font-size: var(--h-l);
  color: var(--primary--dark);
}

h4 {
  font-size: var(--h-m);
}

h5 {
  font-size: var(--h-s);
}

h6 {
  font-size: var(--h-xs);
}

/* Horizontal Rules */
hr {
  border: none;
  border-top: 2px solid var(--hr);
  margin: var(--s-6) 0;
}

/* Paragraphs */
p {
  margin-bottom: var(--s-4);
  font-size: var(--b-m);
}

/* Links */
a {
  color: var(--inline-links);
  text-decoration: none;
  transition: color 0.15s ease;
}

a:hover {
  color: var(--inline-links--hover);
  text-decoration: underline;
}

a:visited {
  color: var(--inline-links--visited);
}

/* Blockquotes */
blockquote {
  border-left: 4px solid var(--primary);
  background-color: var(--primary--extra-light);
  padding: var(--s-4) var(--s-5);
  margin: var(--s-5) 0;
  border-radius: 0 8px 8px 0;
}

blockquote p {
  margin-bottom: 0;
}

/* Lists */
ul, ol {
  margin-bottom: var(--s-4);
  padding-left: var(--s-5);
}

li {
  margin-bottom: var(--s-2);
  line-height: 1.6;
}

/* Nested lists */
ul ul, ol ol, ul ol, ol ul {
  margin-top: var(--s-2);
  margin-bottom: 0;
}

/* Task Lists */
ul.task-list {
  list-style: none;
  padding-left: 0;
}

ul.task-list li {
  padding-left: var(--s-1);
}

/* Inline code */
code {
  background-color: var(--neutral--light);
  padding: 0.15em 0.4em;
  border-radius: 4px;
  font-size: 0.9em;
  color: var(--tertiary--dark);
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
}

/* Code blocks */
pre {
  background-color: #f8f9fa;
  color: #333333;
  border: 1px solid var(--neutral--medium-light);
  padding: var(--s-4);
  border-radius: 8px;
  overflow-x: auto;
  margin: var(--s-5) 0;
  font-size: var(--b-xs);
  line-height: 1.5;
}

pre code {
  background-color: transparent;
  padding: 0;
  color: inherit;
}

/* Mermaid diagrams */
.mermaid {
  margin: var(--s-5) 0;
  text-align: center;
  background-color: var(--neutral--white);
  padding: var(--s-4);
  border-radius: 8px;
  border: 1px solid var(--neutral--medium-light);
}
  </style>
  <!-- ========== Prism.JS Syntax Highlighting ========== -->

  <!-- Prism theme (choose one theme below) -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism.css"
  />

  <!-- Core Prism library -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>

  <!-- Add languages you need -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-csharp.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-json.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-sql.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-typescript.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-yaml.js"></script>

  <!-- Automatically highlight code after page load -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      if (window.Prism) {
        Prism.highlightAll();
      }
    });
  </script>

  <!-- ========== Mermaid Rendering ========== -->

  <!-- Use stable UMD build -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Find code blocks that came from ```mermaid fences
      const mermaidCodeBlocks = document.querySelectorAll(
        'pre.mermaid > code, pre > code.language-mermaid'
      );

      mermaidCodeBlocks.forEach(code => {
        const pre = code.parentElement;
        const parent = pre?.parentElement;
        if (!pre || !parent) return;

        const text = (code.textContent || '').trim();
        if (!text) return;

        // Replace <pre><code> with <div class="mermaid">...</div>
        const div = document.createElement('div');
        div.className = 'mermaid';
        div.textContent = text;

        parent.replaceChild(div, pre);
      });

      mermaid.initialize({
        startOnLoad: true
      });
    });
  </script>
  <!-- Navigation CSS and JS -->
  <link rel="stylesheet" href="navigation.css" />
  <script src="navigation.js" defer></script>
  <script src="/auth-check.js"></script>
</head>
<body>
<h1 id="azure-pem-data-model">Azure PEM Data Model</h1>
<p><strong>Version:</strong> 1.0<br />
<strong>Last Updated:</strong> January 15, 2026<br />
<strong>Author:</strong> Andy Bratton<br />
<strong>Status:</strong> Planning Phase<br />
<strong>Parent Document:</strong> <a
href="01-AZURE-PEM-MASTER-PLAN.html">01-AZURE-PEM-MASTER-PLAN.md</a></p>
<hr />
<h2 id="overview">Overview</h2>
<p>This document defines the complete data model for the Azure PEM
(Prospective Episode Manager) system. The data model supports
episode-of-care management, contract-based modeling, and integration
with the on-premises Contract Manager system.</p>
<hr />
<h2 id="design-principles">Design Principles</h2>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr>
<th>Principle</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Tenant Isolation</strong></td>
<td>All entities include <code>TenantId</code> for multi-tenant data
isolation</td>
</tr>
<tr>
<td><strong>Soft Deletes</strong></td>
<td>Entities use <code>IsDeleted</code> flag rather than hard
deletes</td>
</tr>
<tr>
<td><strong>Audit Trail</strong></td>
<td>All entities track <code>CreatedAt</code>, <code>CreatedBy</code>,
<code>ModifiedAt</code>, <code>ModifiedBy</code></td>
</tr>
<tr>
<td><strong>Optimistic Concurrency</strong></td>
<td><code>RowVersion</code> for concurrent update detection</td>
</tr>
<tr>
<td><strong>External References</strong></td>
<td>Foreign keys to Contract Manager use string IDs (not joined)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="entity-relationship-diagram">Entity Relationship Diagram</h2>
<p><strong>Entity Relationships</strong></p>
<table>
<thead>
<tr>
<th>Parent Entity</th>
<th>Relationship</th>
<th>Child Entity</th>
</tr>
</thead>
<tbody>
<tr>
<td>ContractProfile</td>
<td>1:N</td>
<td>EpisodeDefinition</td>
</tr>
<tr>
<td>EpisodeDefinition</td>
<td>1:N</td>
<td>DefinitionVersion</td>
</tr>
<tr>
<td>DefinitionVersion</td>
<td>1:N</td>
<td>Episode</td>
</tr>
<tr>
<td>ContractProfile</td>
<td>1:N</td>
<td>Episode</td>
</tr>
<tr>
<td>Episode</td>
<td>1:N</td>
<td>EpisodeClaim</td>
</tr>
<tr>
<td>Episode</td>
<td>1:N</td>
<td>EpisodePhase</td>
</tr>
<tr>
<td>Episode</td>
<td>1:N</td>
<td>EpisodeProvider</td>
</tr>
<tr>
<td>Episode</td>
<td>1:N</td>
<td>EpisodeNote</td>
</tr>
<tr>
<td>Episode</td>
<td>1:N</td>
<td>EpisodeStatusHistory</td>
</tr>
<tr>
<td>ModelingScenario</td>
<td>1:N</td>
<td>ScenarioComparison</td>
</tr>
<tr>
<td>ContractProfile</td>
<td>1:N</td>
<td>ScenarioComparison</td>
</tr>
<tr>
<td>ModelingScenario</td>
<td>1:N</td>
<td>Episode</td>
</tr>
<tr>
<td>SavedWorklist</td>
<td>1:N</td>
<td>WorklistShare</td>
</tr>
</tbody>
</table>
<p><strong>ContractProfile</strong> | Column | Type | Notes |
|——–|——|——-| | Id | uniqueidentifier | PK | | ContractId | string | CM
Reference | | Name | string | | | EffectiveDate | date | | |
TerminationDate | date | | | BundlingRulesJson | string | | | TenantId |
uniqueidentifier | | | IsActive | boolean | | | CreatedAt | datetime | |
| CreatedBy | string | |</p>
<p><strong>EpisodeDefinition</strong> | Column | Type | Notes |
|——–|——|——-| | Id | uniqueidentifier | PK | | ContractProfileId |
uniqueidentifier | FK | | Name | string | | | Description | string | | |
EpisodeClass | string | | | IsActive | boolean | | | TenantId |
uniqueidentifier | | | CreatedAt | datetime | |</p>
<p><strong>DefinitionVersion</strong> | Column | Type | Notes |
|——–|——|——-| | Id | uniqueidentifier | PK | | DefinitionId |
uniqueidentifier | FK | | VersionNumber | int | | | EffectiveDate | date
| | | TerminationDate | date | | | Status | string | | |
TriggerRulesJson | string | | | AssociationRulesJson | string | | |
PhasesJson | string | | | CreatedAt | datetime | |</p>
<p><strong>Episode</strong> | Column | Type | Notes | |——–|——|——-| | Id
| uniqueidentifier | PK | | DefinitionVersionId | uniqueidentifier | FK
| | ContractProfileId | uniqueidentifier | FK | | ModelingScenarioId |
uniqueidentifier | FK, nullable | | TenantId | uniqueidentifier | | |
PatientId | string | | | Status | string | | | TriggerDate | date | | |
StartDate | date | | | EndDate | date | | | BundleAmount | decimal | | |
TargetPrice | decimal | | | Variance | decimal | | | IsModelingResult |
boolean | | | CreatedAt | datetime | | | ModifiedAt | datetime |</p>
<pre><code>EpisodeClaim {
    uniqueidentifier Id PK
    uniqueidentifier EpisodeId FK
    string ClaimId &quot;External&quot;
    boolean IsTriggerClaim
    uniqueidentifier PhaseId FK
    date ClaimDate
    decimal ClaimAmount
    datetime AssociatedAt
}

ModelingScenario {
    uniqueidentifier Id PK
    string Name
    string Description
    string BaseClaimSetJson
    string PatientId
    date DateRangeStart
    date DateRangeEnd
    string Status
    string CreatedBy
    uniqueidentifier TenantId
    datetime CreatedAt
}</code></pre>
<pre><code>
---

## Core Entities

### ContractProfile

Represents a contract configuration that defines how episodes are bundled and priced.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `ContractId` | `nvarchar(50)` | No | Reference to Contract Manager contract |
| `Name` | `nvarchar(200)` | No | Display name |
| `Description` | `nvarchar(max)` | Yes | Detailed description |
| `EffectiveDate` | `date` | No | Start of contract validity |
| `TerminationDate` | `date` | Yes | End of contract validity (null = ongoing) |
| `BundlingRulesJson` | `nvarchar(max)` | No | JSON: bundling configuration |
| `PricingMethodJson` | `nvarchar(max)` | Yes | JSON: pricing calculation rules |
| `TenantId` | `uniqueidentifier` | No | Tenant isolation |
| `IsActive` | `bit` | No | Soft active/inactive |
| `IsDeleted` | `bit` | No | Soft delete |
| `CreatedAt` | `datetime2` | No | Creation timestamp |
| `CreatedBy` | `nvarchar(100)` | No | Creator user ID |
| `ModifiedAt` | `datetime2` | Yes | Last modification |
| `ModifiedBy` | `nvarchar(100)` | Yes | Last modifier |
| `RowVersion` | `rowversion` | No | Concurrency token |

**Indexes:**
- `IX_ContractProfile_ContractId` (ContractId, TenantId)
- `IX_ContractProfile_TenantId_IsActive` (TenantId, IsActive) WHERE IsDeleted = 0

---

### EpisodeDefinition

Defines the rules for creating and managing a type of episode.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `ContractProfileId` | `uniqueidentifier` | No | FK to ContractProfile |
| `Name` | `nvarchar(200)` | No | Definition name (e.g., &quot;Hip Replacement&quot;) |
| `Description` | `nvarchar(max)` | Yes | Detailed description |
| `EpisodeClass` | `nvarchar(50)` | No | Category (Surgical, Medical, Maternity, etc.) |
| `IsActive` | `bit` | No | Active for new episodes |
| `IsDeleted` | `bit` | No | Soft delete |
| `TenantId` | `uniqueidentifier` | No | Tenant isolation |
| `CreatedAt` | `datetime2` | No | Creation timestamp |
| `CreatedBy` | `nvarchar(100)` | No | Creator |
| `ModifiedAt` | `datetime2` | Yes | Last modification |
| `ModifiedBy` | `nvarchar(100)` | Yes | Last modifier |
| `RowVersion` | `rowversion` | No | Concurrency token |

**Indexes:**
- `IX_EpisodeDefinition_ContractProfileId` (ContractProfileId)
- `IX_EpisodeDefinition_TenantId_IsActive` (TenantId, IsActive) WHERE IsDeleted = 0

---

### DefinitionVersion

Versioned rules for an episode definition, supporting effective dating.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `DefinitionId` | `uniqueidentifier` | No | FK to EpisodeDefinition |
| `VersionNumber` | `int` | No | Sequential version |
| `EffectiveDate` | `date` | No | When this version becomes active |
| `TerminationDate` | `date` | Yes | When this version expires |
| `Status` | `nvarchar(20)` | No | Draft, Active, Retired |
| `TriggerRulesJson` | `nvarchar(max)` | No | JSON: codes/conditions that trigger episode |
| `AssociationRulesJson` | `nvarchar(max)` | No | JSON: rules for adding claims |
| `PhasesJson` | `nvarchar(max)` | Yes | JSON: phase definitions |
| `PreTriggerDays` | `int` | No | Days before trigger to include |
| `PostTriggerDays` | `int` | No | Days after trigger to include |
| `CreatedAt` | `datetime2` | No | Creation timestamp |
| `CreatedBy` | `nvarchar(100)` | No | Creator |
| `ApprovedAt` | `datetime2` | Yes | When activated |
| `ApprovedBy` | `nvarchar(100)` | Yes | Who approved activation |

**Indexes:**
- `IX_DefinitionVersion_DefinitionId_Status` (DefinitionId, Status)
- `IX_DefinitionVersion_EffectiveDate` (EffectiveDate, TerminationDate)

---

### Episode

A specific episode-of-care instance for a patient.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `EpisodeNumber` | `nvarchar(50)` | No | Human-readable identifier |
| `DefinitionVersionId` | `uniqueidentifier` | No | FK to DefinitionVersion |
| `ContractProfileId` | `uniqueidentifier` | No | FK to ContractProfile |
| `ModelingScenarioId` | `uniqueidentifier` | Yes | FK if this is a modeling result |
| `TenantId` | `uniqueidentifier` | No | Tenant isolation |
| `PatientId` | `nvarchar(50)` | No | External patient reference |
| `PatientMRN` | `nvarchar(50)` | Yes | Medical record number |
| `Status` | `nvarchar(30)` | No | Open, InProgress, Closed, Voided |
| `TriggerDate` | `date` | No | Date of triggering event |
| `StartDate` | `date` | No | Episode start (trigger - pre-days) |
| `EndDate` | `date` | Yes | Episode end (trigger + post-days) |
| `TotalCharges` | `decimal(18,2)` | No | Sum of claim charges |
| `BundleAmount` | `decimal(18,2)` | Yes | Calculated bundle payment |
| `TargetPrice` | `decimal(18,2)` | Yes | Expected bundle price |
| `Variance` | `decimal(18,2)` | Yes | BundleAmount - TargetPrice |
| `VariancePercent` | `decimal(5,2)` | Yes | Variance as percentage |
| `IsModelingResult` | `bit` | No | True if from modeling scenario |
| `FacilityId` | `nvarchar(50)` | Yes | Facility reference |
| `PayerId` | `nvarchar(50)` | Yes | Payer reference |
| `IsDeleted` | `bit` | No | Soft delete |
| `CreatedAt` | `datetime2` | No | Creation timestamp |
| `CreatedBy` | `nvarchar(100)` | No | Creator |
| `ModifiedAt` | `datetime2` | Yes | Last modification |
| `ModifiedBy` | `nvarchar(100)` | Yes | Last modifier |
| `RowVersion` | `rowversion` | No | Concurrency token |

**Indexes:**
- `IX_Episode_TenantId_Status` (TenantId, Status) WHERE IsDeleted = 0
- `IX_Episode_PatientId` (PatientId, TenantId)
- `IX_Episode_TriggerDate` (TriggerDate, TenantId)
- `IX_Episode_DefinitionVersionId` (DefinitionVersionId)
- `IX_Episode_ModelingScenarioId` (ModelingScenarioId) WHERE ModelingScenarioId IS NOT NULL

---

### EpisodeClaim

Claims associated with an episode.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `EpisodeId` | `uniqueidentifier` | No | FK to Episode |
| `ClaimId` | `nvarchar(50)` | No | External claim reference |
| `ClaimNumber` | `nvarchar(50)` | Yes | Claim number for display |
| `IsTriggerClaim` | `bit` | No | Is this the triggering claim |
| `PhaseId` | `uniqueidentifier` | Yes | FK to EpisodePhase |
| `ClaimType` | `nvarchar(10)` | No | H (Hospital), U (Professional) |
| `ClaimDate` | `date` | No | Date of service |
| `ServiceFromDate` | `date` | No | Service period start |
| `ServiceToDate` | `date` | No | Service period end |
| `ChargeAmount` | `decimal(18,2)` | No | Billed charges |
| `AllowedAmount` | `decimal(18,2)` | Yes | Allowed amount |
| `PaidAmount` | `decimal(18,2)` | Yes | Paid amount |
| `DiagnosisCodes` | `nvarchar(max)` | Yes | JSON array of diagnosis codes |
| `ProcedureCodes` | `nvarchar(max)` | Yes | JSON array of procedure codes |
| `DRG` | `nvarchar(10)` | Yes | DRG code if applicable |
| `ProviderId` | `nvarchar(50)` | Yes | Provider reference |
| `ProviderName` | `nvarchar(200)` | Yes | Provider name |
| `AssociatedAt` | `datetime2` | No | When claim was added |
| `AssociatedBy` | `nvarchar(100)` | No | Who added the claim |
| `AssociationMethod` | `nvarchar(20)` | No | Auto, Manual |
| `IsExcluded` | `bit` | No | Excluded from bundle calculation |
| `ExclusionReason` | `nvarchar(200)` | Yes | Why excluded |

**Indexes:**
- `IX_EpisodeClaim_EpisodeId` (EpisodeId)
- `IX_EpisodeClaim_ClaimId` (ClaimId)
- `IX_EpisodeClaim_ClaimDate` (ClaimDate)

---

### EpisodePhase

Phases within an episode (Pre-Op, Procedure, Post-Acute, etc.).

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `EpisodeId` | `uniqueidentifier` | No | FK to Episode |
| `Name` | `nvarchar(100)` | No | Phase name |
| `Sequence` | `int` | No | Display order |
| `StartDate` | `date` | No | Phase start |
| `EndDate` | `date` | Yes | Phase end |
| `TotalCharges` | `decimal(18,2)` | No | Sum of phase claim charges |
| `ClaimCount` | `int` | No | Number of claims in phase |

**Indexes:**
- `IX_EpisodePhase_EpisodeId` (EpisodeId)

---

### EpisodeProvider

Providers involved in an episode.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `EpisodeId` | `uniqueidentifier` | No | FK to Episode |
| `ProviderId` | `nvarchar(50)` | No | External provider reference |
| `ProviderName` | `nvarchar(200)` | No | Provider name |
| `ProviderNPI` | `nvarchar(20)` | Yes | NPI if available |
| `Role` | `nvarchar(50)` | No | Attending, Surgeon, PCP, etc. |
| `IsPrimary` | `bit` | No | Primary provider for episode |
| `Specialty` | `nvarchar(100)` | Yes | Provider specialty |

**Indexes:**
- `IX_EpisodeProvider_EpisodeId` (EpisodeId)
- `IX_EpisodeProvider_ProviderId` (ProviderId)

---

### EpisodeNote

Notes and comments on episodes.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `EpisodeId` | `uniqueidentifier` | No | FK to Episode |
| `NoteType` | `nvarchar(50)` | No | General, Review, Audit, etc. |
| `NoteText` | `nvarchar(max)` | No | Note content |
| `CreatedAt` | `datetime2` | No | Creation timestamp |
| `CreatedBy` | `nvarchar(100)` | No | Author |
| `IsDeleted` | `bit` | No | Soft delete |

**Indexes:**
- `IX_EpisodeNote_EpisodeId` (EpisodeId) WHERE IsDeleted = 0

---

### EpisodeStatusHistory

Audit trail of episode status changes.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `EpisodeId` | `uniqueidentifier` | No | FK to Episode |
| `FromStatus` | `nvarchar(30)` | Yes | Previous status |
| `ToStatus` | `nvarchar(30)` | No | New status |
| `ChangedAt` | `datetime2` | No | When changed |
| `ChangedBy` | `nvarchar(100)` | No | Who changed |
| `Reason` | `nvarchar(500)` | Yes | Reason for change |

**Indexes:**
- `IX_EpisodeStatusHistory_EpisodeId` (EpisodeId)

---

## Modeling Entities

### ModelingScenario

A what-if modeling scenario for comparing contract configurations.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `Name` | `nvarchar(200)` | No | Scenario name |
| `Description` | `nvarchar(max)` | Yes | Description |
| `BaseClaimSetJson` | `nvarchar(max)` | No | JSON: source claims for modeling |
| `PatientId` | `nvarchar(50)` | Yes | If patient-specific |
| `DateRangeStart` | `date` | No | Claim date range start |
| `DateRangeEnd` | `date` | No | Claim date range end |
| `Status` | `nvarchar(30)` | No | Draft, Processing, Complete, Error |
| `TenantId` | `uniqueidentifier` | No | Tenant isolation |
| `CreatedBy` | `nvarchar(100)` | No | Creator |
| `CreatedAt` | `datetime2` | No | Creation timestamp |
| `CompletedAt` | `datetime2` | Yes | When processing completed |
| `IsDeleted` | `bit` | No | Soft delete |

**Indexes:**
- `IX_ModelingScenario_TenantId_Status` (TenantId, Status) WHERE IsDeleted = 0
- `IX_ModelingScenario_CreatedBy` (CreatedBy, TenantId)

---

### ScenarioComparison

Results of running a scenario against a specific contract profile.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `ScenarioId` | `uniqueidentifier` | No | FK to ModelingScenario |
| `ContractProfileId` | `uniqueidentifier` | No | FK to ContractProfile |
| `EpisodeCount` | `int` | No | Number of episodes created |
| `TotalCharges` | `decimal(18,2)` | No | Total claim charges |
| `TotalBundleAmount` | `decimal(18,2)` | No | Total bundle payments |
| `VarianceFromBase` | `decimal(18,2)` | Yes | Comparison to base scenario |
| `VariancePercent` | `decimal(5,2)` | Yes | Percentage variance |
| `ResultsJson` | `nvarchar(max)` | No | JSON: detailed results |
| `CalculatedAt` | `datetime2` | No | When calculated |

**Indexes:**
- `IX_ScenarioComparison_ScenarioId` (ScenarioId)
- `IX_ScenarioComparison_ContractProfileId` (ContractProfileId)

---

## Worklist Entities

### SavedWorklist

User-saved worklist configurations.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `Name` | `nvarchar(200)` | No | Worklist name |
| `Description` | `nvarchar(500)` | Yes | Description |
| `WorklistType` | `nvarchar(50)` | No | Episodes, Claims, Scenarios |
| `CriteriaJson` | `nvarchar(max)` | No | JSON: search criteria |
| `ColumnsJson` | `nvarchar(max)` | No | JSON: column configuration |
| `SortJson` | `nvarchar(max)` | Yes | JSON: sort configuration |
| `IsDefault` | `bit` | No | Default worklist for user |
| `IsShared` | `bit` | No | Available to other users |
| `TenantId` | `uniqueidentifier` | No | Tenant isolation |
| `OwnerId` | `nvarchar(100)` | No | Owner user ID |
| `CreatedAt` | `datetime2` | No | Creation timestamp |
| `ModifiedAt` | `datetime2` | Yes | Last modification |

**Indexes:**
- `IX_SavedWorklist_OwnerId` (OwnerId, TenantId)
- `IX_SavedWorklist_TenantId_IsShared` (TenantId, IsShared)

---

### WorklistShare

Sharing configuration for worklists.

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| `Id` | `uniqueidentifier` | No | Primary key |
| `WorklistId` | `uniqueidentifier` | No | FK to SavedWorklist |
| `SharedWithUserId` | `nvarchar(100)` | Yes | Specific user (null = all) |
| `SharedWithGroupId` | `nvarchar(100)` | Yes | Specific group |
| `Permission` | `nvarchar(20)` | No | View, Edit |
| `SharedAt` | `datetime2` | No | When shared |
| `SharedBy` | `nvarchar(100)` | No | Who shared |

**Indexes:**
- `IX_WorklistShare_WorklistId` (WorklistId)
- `IX_WorklistShare_SharedWithUserId` (SharedWithUserId)

---

## Lookup/Reference Entities

### EpisodeStatus (Enum)

| Value | Description |
|-------|-------------|
| `Open` | Episode created, still accepting claims |
| `InProgress` | Episode being worked/reviewed |
| `PendingReview` | Awaiting review/approval |
| `Closed` | Episode complete |
| `Voided` | Episode cancelled |

### ClaimType (Enum)

| Value | Description |
|-------|-------------|
| `H` | Hospital/Institutional |
| `U` | Professional/Physician |

### DefinitionStatus (Enum)

| Value | Description |
|-------|-------------|
| `Draft` | Under construction |
| `Active` | Currently in use |
| `Retired` | No longer creating new episodes |

---

## JSON Schema Definitions

### TriggerRulesJson

```json
{
  &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;properties&quot;: {
    &quot;diagnosisCodes&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;type&quot;: &quot;object&quot;,
        &quot;properties&quot;: {
          &quot;code&quot;: { &quot;type&quot;: &quot;string&quot; },
          &quot;codeSystem&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;enum&quot;: [&quot;ICD10&quot;, &quot;ICD9&quot;] },
          &quot;position&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;enum&quot;: [&quot;Primary&quot;, &quot;Any&quot;] }
        }
      }
    },
    &quot;procedureCodes&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;type&quot;: &quot;object&quot;,
        &quot;properties&quot;: {
          &quot;code&quot;: { &quot;type&quot;: &quot;string&quot; },
          &quot;codeSystem&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;enum&quot;: [&quot;CPT&quot;, &quot;HCPCS&quot;, &quot;ICD10PCS&quot;] }
        }
      }
    },
    &quot;drgCodes&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: { &quot;type&quot;: &quot;string&quot; }
    },
    &quot;claimTypes&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;enum&quot;: [&quot;H&quot;, &quot;U&quot;] }
    }
  }
}</code></pre>
<h3 id="associationrulesjson">AssociationRulesJson</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;$schema&quot;</span><span class="fu">:</span> <span class="st">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="fu">,</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;object&quot;</span><span class="fu">,</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;includeRules&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;array&quot;</span><span class="fu">,</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;items&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;object&quot;</span><span class="fu">,</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;ruleType&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;string&quot;</span><span class="fu">,</span> <span class="dt">&quot;enum&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;SamePatient&quot;</span><span class="ot">,</span> <span class="st">&quot;DateRange&quot;</span><span class="ot">,</span> <span class="st">&quot;DiagnosisRelated&quot;</span><span class="ot">,</span> <span class="st">&quot;ProviderRelated&quot;</span><span class="ot">]</span> <span class="fu">},</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;parameters&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;object&quot;</span> <span class="fu">}</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">},</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;excludeRules&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;array&quot;</span><span class="fu">,</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;items&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;object&quot;</span><span class="fu">,</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;ruleType&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;string&quot;</span> <span class="fu">},</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;parameters&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;object&quot;</span> <span class="fu">}</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<hr />
<h2 id="database-migration-strategy">Database Migration Strategy</h2>
<h3 id="entity-framework-core-migrations">Entity Framework Core
Migrations</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create migration</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">dotnet</span> ef migrations add InitialCreate <span class="at">-p</span> PEM.Infrastructure <span class="at">-s</span> PEM.Api.Episodes</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply migration</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="ex">dotnet</span> ef database update <span class="at">-p</span> PEM.Infrastructure <span class="at">-s</span> PEM.Api.Episodes</span></code></pre></div>
<h3 id="environment-specific-configuration">Environment-Specific
Configuration</h3>
<table>
<thead>
<tr>
<th>Environment</th>
<th>Database</th>
<th>Configuration</th>
</tr>
</thead>
<tbody>
<tr>
<td>dev</td>
<td><code>pem-db-dev</code></td>
<td>Shared SQL Server (nonprod)</td>
</tr>
<tr>
<td>qae</td>
<td><code>pem-db-qae</code></td>
<td>Shared SQL Server (nonprod)</td>
</tr>
<tr>
<td>uat</td>
<td><code>pem-db-uat</code></td>
<td>Isolated SQL Server</td>
</tr>
<tr>
<td>prod</td>
<td><code>pem-db-prod</code></td>
<td>Isolated SQL Server (Business Critical)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="performance-considerations">Performance Considerations</h2>
<h3 id="indexing-strategy">Indexing Strategy</h3>
<ol type="1">
<li><strong>Tenant isolation</strong>: All queries should include
<code>TenantId</code></li>
<li><strong>Soft deletes</strong>: Filtered indexes exclude deleted
records</li>
<li><strong>Date ranges</strong>: Composite indexes on date columns for
range queries</li>
<li><strong>Foreign keys</strong>: Indexes on all FK columns</li>
</ol>
<h3 id="partitioning-production">Partitioning (Production)</h3>
<p>Consider partitioning large tables by: - <code>TriggerDate</code> for
Episode table - <code>ClaimDate</code> for EpisodeClaim table</p>
<h3 id="read-replicas">Read Replicas</h3>
<p>For reporting workloads, use Azure SQL read replicas to offload query
traffic from the primary database.</p>
<hr />
<h2 id="azure-cosmos-db-document-models">Azure Cosmos DB Document
Models</h2>
<blockquote>
<p><strong>Polyglot Persistence:</strong> Since JSON is the internal
communication language between all API components, certain data types
are better suited to Azure Cosmos DB’s document model rather than Azure
SQL’s relational model.</p>
</blockquote>
<h3 id="when-to-use-cosmos-db-vs-azure-sql">When to Use Cosmos DB vs
Azure SQL</h3>
<table>
<colgroup>
<col style="width: 51%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr>
<th>Use Cosmos DB When</th>
<th>Use Azure SQL When</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data is naturally JSON with flexible schema</td>
<td>Data has strict relational integrity requirements</td>
</tr>
<tr>
<td>High-throughput, low-latency reads/writes</td>
<td>Complex JOIN queries across entities</td>
</tr>
<tr>
<td>Schema evolves frequently per tenant</td>
<td>ACID transactions across multiple tables</td>
</tr>
<tr>
<td>Document-centric access patterns</td>
<td>Reporting and analytical workloads</td>
</tr>
<tr>
<td>Event sourcing / append-only logs</td>
<td>Entity Framework Core migrations</td>
</tr>
</tbody>
</table>
<h3 id="cosmos-db-containers">Cosmos DB Containers</h3>
<h4 id="modeling-scenarios-container"><code>modeling-scenarios</code>
Container</h4>
<p><strong>Partition Key:</strong> <code>/tenantId</code></p>
<p>Stores what-if modeling scenarios with full JSON payloads for
scenario comparisons.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;3fa85f64-5717-4562-b3fc-2c963f66afa6&quot;</span><span class="fu">,</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;tenantId&quot;</span><span class="fu">:</span> <span class="st">&quot;tenant-123&quot;</span><span class="fu">,</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Q1 2026 Contract Renegotiation&quot;</span><span class="fu">,</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Compare current vs proposed bundling rates&quot;</span><span class="fu">,</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;createdAt&quot;</span><span class="fu">:</span> <span class="st">&quot;2026-01-15T10:30:00Z&quot;</span><span class="fu">,</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;createdBy&quot;</span><span class="fu">:</span> <span class="st">&quot;user@finthrive.com&quot;</span><span class="fu">,</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;Completed&quot;</span><span class="fu">,</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;baselineContractId&quot;</span><span class="fu">:</span> <span class="st">&quot;contract-456&quot;</span><span class="fu">,</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;comparisonContracts&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;contract-789&quot;</span><span class="ot">,</span> <span class="st">&quot;contract-012&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;parameters&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;dateRange&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;start&quot;</span><span class="fu">:</span> <span class="st">&quot;2025-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;end&quot;</span><span class="fu">:</span> <span class="st">&quot;2025-12-31&quot;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">},</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;episodeFilters&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;definitionIds&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;def-001&quot;</span><span class="ot">,</span> <span class="st">&quot;def-002&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;minClaimCount&quot;</span><span class="fu">:</span> <span class="dv">3</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;results&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;baselineTotal&quot;</span><span class="fu">:</span> <span class="fl">1250000.00</span><span class="fu">,</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;comparisons&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;contractId&quot;</span><span class="fu">:</span> <span class="st">&quot;contract-789&quot;</span><span class="fu">,</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;total&quot;</span><span class="fu">:</span> <span class="fl">1180000.00</span><span class="fu">,</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;variance&quot;</span><span class="fu">:</span> <span class="fl">-70000.00</span><span class="fu">,</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;variancePercent&quot;</span><span class="fu">:</span> <span class="fl">-5.6</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;episodeSummaries&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="er">...</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;calculatedAt&quot;</span><span class="fu">:</span> <span class="st">&quot;2026-01-15T10:35:00Z&quot;</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;_ts&quot;</span><span class="fu">:</span> <span class="dv">1736939700</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h4 id="user-worklists-container"><code>user-worklists</code>
Container</h4>
<p><strong>Partition Key:</strong> <code>/userId</code></p>
<p>Stores user-specific saved worklists with flexible filter
configurations.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;worklist-abc123&quot;</span><span class="fu">,</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;userId&quot;</span><span class="fu">:</span> <span class="st">&quot;user@finthrive.com&quot;</span><span class="fu">,</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;tenantId&quot;</span><span class="fu">:</span> <span class="st">&quot;tenant-123&quot;</span><span class="fu">,</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;High Variance Episodes - Cardiology&quot;</span><span class="fu">,</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Episodes with &gt;10% variance from target&quot;</span><span class="fu">,</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;isDefault&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;isShared&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;sharedWith&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;team-analysts&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;createdAt&quot;</span><span class="fu">:</span> <span class="st">&quot;2026-01-10T08:00:00Z&quot;</span><span class="fu">,</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;lastAccessedAt&quot;</span><span class="fu">:</span> <span class="st">&quot;2026-01-15T09:00:00Z&quot;</span><span class="fu">,</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;configuration&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;columns&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span><span class="dt">&quot;field&quot;</span><span class="fu">:</span> <span class="st">&quot;patientName&quot;</span><span class="fu">,</span> <span class="dt">&quot;visible&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span> <span class="dt">&quot;width&quot;</span><span class="fu">:</span> <span class="dv">150</span><span class="fu">,</span> <span class="dt">&quot;order&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span><span class="dt">&quot;field&quot;</span><span class="fu">:</span> <span class="st">&quot;triggerDate&quot;</span><span class="fu">,</span> <span class="dt">&quot;visible&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span> <span class="dt">&quot;width&quot;</span><span class="fu">:</span> <span class="dv">100</span><span class="fu">,</span> <span class="dt">&quot;order&quot;</span><span class="fu">:</span> <span class="dv">2</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span><span class="dt">&quot;field&quot;</span><span class="fu">:</span> <span class="st">&quot;variance&quot;</span><span class="fu">,</span> <span class="dt">&quot;visible&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span> <span class="dt">&quot;width&quot;</span><span class="fu">:</span> <span class="dv">80</span><span class="fu">,</span> <span class="dt">&quot;order&quot;</span><span class="fu">:</span> <span class="dv">3</span><span class="fu">}</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;filters&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;Active&quot;</span><span class="ot">,</span> <span class="st">&quot;InProgress&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;variancePercent&quot;</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">&quot;operator&quot;</span><span class="fu">:</span> <span class="st">&quot;gt&quot;</span><span class="fu">,</span> <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="dv">10</span><span class="fu">},</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;definitionName&quot;</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">&quot;operator&quot;</span><span class="fu">:</span> <span class="st">&quot;contains&quot;</span><span class="fu">,</span> <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;Cardiology&quot;</span><span class="fu">}</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">},</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;sorting&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span><span class="dt">&quot;field&quot;</span><span class="fu">:</span> <span class="st">&quot;variance&quot;</span><span class="fu">,</span> <span class="dt">&quot;direction&quot;</span><span class="fu">:</span> <span class="st">&quot;desc&quot;</span><span class="fu">}</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;pageSize&quot;</span><span class="fu">:</span> <span class="dv">50</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;_ts&quot;</span><span class="fu">:</span> <span class="dv">1736931600</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h4 id="contract-profiles-container"><code>contract-profiles</code>
Container</h4>
<p><strong>Partition Key:</strong> <code>/tenantId</code></p>
<p>Stores contract configurations with complex nested bundling rules as
JSON.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;profile-xyz789&quot;</span><span class="fu">,</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;tenantId&quot;</span><span class="fu">:</span> <span class="st">&quot;tenant-123&quot;</span><span class="fu">,</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;contractId&quot;</span><span class="fu">:</span> <span class="st">&quot;CM-CONTRACT-456&quot;</span><span class="fu">,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;BlueCross Episode Bundle Agreement 2026&quot;</span><span class="fu">,</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="dv">3</span><span class="fu">,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;effectiveDate&quot;</span><span class="fu">:</span> <span class="st">&quot;2026-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;terminationDate&quot;</span><span class="fu">:</span> <span class="st">&quot;2026-12-31&quot;</span><span class="fu">,</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;isActive&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;bundlingRules&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;triggerRules&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Inpatient Admission Trigger&quot;</span><span class="fu">,</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;condition&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;claimType&quot;</span><span class="fu">:</span> <span class="st">&quot;Inpatient&quot;</span><span class="fu">,</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;procedureCodes&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;99221&quot;</span><span class="ot">,</span> <span class="st">&quot;99222&quot;</span><span class="ot">,</span> <span class="st">&quot;99223&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;logic&quot;</span><span class="fu">:</span> <span class="st">&quot;ANY&quot;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;associationRules&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;30-Day Post-Discharge&quot;</span><span class="fu">,</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;windowDays&quot;</span><span class="fu">:</span> <span class="dv">30</span><span class="fu">,</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;includeCriteria&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;claimTypes&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;Outpatient&quot;</span><span class="ot">,</span> <span class="st">&quot;Professional&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;excludeProcedures&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;99381-99397&quot;</span><span class="ot">]</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;pricingRules&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;method&quot;</span><span class="fu">:</span> <span class="st">&quot;CaseRate&quot;</span><span class="fu">,</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;baseRate&quot;</span><span class="fu">:</span> <span class="fl">15000.00</span><span class="fu">,</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;adjustments&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;Severity&quot;</span><span class="fu">,</span> <span class="dt">&quot;multipliers&quot;</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">&quot;low&quot;</span><span class="fu">:</span> <span class="fl">0.8</span><span class="fu">,</span> <span class="dt">&quot;medium&quot;</span><span class="fu">:</span> <span class="fl">1.0</span><span class="fu">,</span> <span class="dt">&quot;high&quot;</span><span class="fu">:</span> <span class="fl">1.4</span><span class="fu">}}</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;createdAt&quot;</span><span class="fu">:</span> <span class="st">&quot;2025-12-01T00:00:00Z&quot;</span><span class="fu">,</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;modifiedAt&quot;</span><span class="fu">:</span> <span class="st">&quot;2025-12-15T14:30:00Z&quot;</span><span class="fu">,</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;_ts&quot;</span><span class="fu">:</span> <span class="dv">1734271800</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h4 id="audit-events-container"><code>audit-events</code> Container</h4>
<p><strong>Partition Key:</strong> <code>/entityType</code>
(hierarchical with <code>/entityId</code>)</p>
<p>Immutable event log for compliance and audit trail.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;evt-20260115-103000-abc123&quot;</span><span class="fu">,</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;entityType&quot;</span><span class="fu">:</span> <span class="st">&quot;Episode&quot;</span><span class="fu">,</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;entityId&quot;</span><span class="fu">:</span> <span class="st">&quot;episode-12345&quot;</span><span class="fu">,</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;tenantId&quot;</span><span class="fu">:</span> <span class="st">&quot;tenant-123&quot;</span><span class="fu">,</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;eventType&quot;</span><span class="fu">:</span> <span class="st">&quot;StatusChanged&quot;</span><span class="fu">,</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;timestamp&quot;</span><span class="fu">:</span> <span class="st">&quot;2026-01-15T10:30:00Z&quot;</span><span class="fu">,</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;userId&quot;</span><span class="fu">:</span> <span class="st">&quot;user@finthrive.com&quot;</span><span class="fu">,</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;userDisplayName&quot;</span><span class="fu">:</span> <span class="st">&quot;John Smith&quot;</span><span class="fu">,</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;ipAddress&quot;</span><span class="fu">:</span> <span class="st">&quot;10.0.1.50&quot;</span><span class="fu">,</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;changes&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;before&quot;</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;Active&quot;</span><span class="fu">},</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;after&quot;</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;Closed&quot;</span><span class="fu">}</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;metadata&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;reason&quot;</span><span class="fu">:</span> <span class="st">&quot;Episode completed per protocol&quot;</span><span class="fu">,</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;correlationId&quot;</span><span class="fu">:</span> <span class="st">&quot;req-abc123&quot;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;ttl&quot;</span><span class="fu">:</span> <span class="dv">31536000</span><span class="fu">,</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;_ts&quot;</span><span class="fu">:</span> <span class="dv">1736939400</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="cosmos-db-access-patterns">Cosmos DB Access Patterns</h3>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 30%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr>
<th>Pattern</th>
<th>Container</th>
<th>Query Strategy</th>
</tr>
</thead>
<tbody>
<tr>
<td>Get user’s worklists</td>
<td><code>user-worklists</code></td>
<td>Point read by <code>userId</code> partition</td>
</tr>
<tr>
<td>Get modeling scenario</td>
<td><code>modeling-scenarios</code></td>
<td>Point read by <code>id</code> + <code>tenantId</code></td>
</tr>
<tr>
<td>List scenarios for tenant</td>
<td><code>modeling-scenarios</code></td>
<td>Query by <code>tenantId</code> partition</td>
</tr>
<tr>
<td>Get contract profile</td>
<td><code>contract-profiles</code></td>
<td>Point read by <code>id</code> + <code>tenantId</code></td>
</tr>
<tr>
<td>Audit history for entity</td>
<td><code>audit-events</code></td>
<td>Query by <code>entityType</code> + <code>entityId</code></td>
</tr>
<tr>
<td>Recent events (Change Feed)</td>
<td><code>audit-events</code></td>
<td>Change Feed processor for real-time</td>
</tr>
</tbody>
</table>
<h3 id="net-integration-with-cosmos-db">.NET Integration with Cosmos
DB</h3>
<div class="sourceCode" id="cb9"><pre
class="sourceCode csharp"><code class="sourceCode cs"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cosmos DB repository pattern</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">interface</span> ICosmosRepository<span class="op">&lt;</span>T<span class="op">&gt;</span> where T <span class="op">:</span> <span class="kw">class</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    Task<span class="op">&lt;</span>T<span class="op">?&gt;</span> <span class="fu">GetByIdAsync</span><span class="op">(</span><span class="dt">string</span> id<span class="op">,</span> <span class="dt">string</span> partitionKey<span class="op">);</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    Task<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="fu">CreateAsync</span><span class="op">(</span>T entity<span class="op">,</span> <span class="dt">string</span> partitionKey<span class="op">);</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    Task<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="fu">UpdateAsync</span><span class="op">(</span>T entity<span class="op">,</span> <span class="dt">string</span> partitionKey<span class="op">);</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    Task <span class="fu">DeleteAsync</span><span class="op">(</span><span class="dt">string</span> id<span class="op">,</span> <span class="dt">string</span> partitionKey<span class="op">);</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    Task<span class="op">&lt;</span>IEnumerable<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> <span class="fu">QueryAsync</span><span class="op">(</span><span class="dt">string</span> query<span class="op">,</span> <span class="dt">string</span> partitionKey<span class="op">);</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Example: Modeling Scenario Repository</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ModelingScenarioRepository <span class="op">:</span> ICosmosRepository<span class="op">&lt;</span>ModelingScenario<span class="op">&gt;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">readonly</span> Container _container<span class="op">;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="fu">ModelingScenarioRepository</span><span class="op">(</span>CosmosClient cosmosClient<span class="op">)</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        _container <span class="op">=</span> cosmosClient<span class="op">.</span><span class="fu">GetContainer</span><span class="op">(</span><span class="st">&quot;pem-documents&quot;</span><span class="op">,</span> <span class="st">&quot;modeling-scenarios&quot;</span><span class="op">);</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>ModelingScenario<span class="op">?&gt;</span> <span class="fu">GetByIdAsync</span><span class="op">(</span><span class="dt">string</span> id<span class="op">,</span> <span class="dt">string</span> tenantId<span class="op">)</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> response <span class="op">=</span> await _container<span class="op">.</span><span class="fu">ReadItemAsync</span><span class="op">&lt;</span>ModelingScenario<span class="op">&gt;(</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                id<span class="op">,</span> </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span> <span class="fu">PartitionKey</span><span class="op">(</span>tenantId<span class="op">)</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>            <span class="op">);</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> response<span class="op">.</span><span class="fu">Resource</span><span class="op">;</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>CosmosException ex<span class="op">)</span> <span class="fu">when</span> <span class="op">(</span>ex<span class="op">.</span><span class="fu">StatusCode</span> <span class="op">==</span> HttpStatusCode<span class="op">.</span><span class="fu">NotFound</span><span class="op">)</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>IEnumerable<span class="op">&lt;</span>ModelingScenario<span class="op">&gt;&gt;</span> <span class="fu">GetByTenantAsync</span><span class="op">(</span><span class="dt">string</span> tenantId<span class="op">)</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> query <span class="op">=</span> <span class="kw">new</span> <span class="fu">QueryDefinition</span><span class="op">(</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;SELECT * FROM c WHERE c.tenantId = @tenantId ORDER BY c.createdAt DESC&quot;</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">).</span><span class="fu">WithParameter</span><span class="op">(</span><span class="st">&quot;@tenantId&quot;</span><span class="op">,</span> tenantId<span class="op">);</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> iterator <span class="op">=</span> _container<span class="op">.</span><span class="fu">GetItemQueryIterator</span><span class="op">&lt;</span>ModelingScenario<span class="op">&gt;(</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>            query<span class="op">,</span> </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>            requestOptions<span class="op">:</span> <span class="kw">new</span> QueryRequestOptions <span class="op">{</span> PartitionKey <span class="op">=</span> <span class="kw">new</span> <span class="fu">PartitionKey</span><span class="op">(</span>tenantId<span class="op">)</span> <span class="op">}</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">);</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> results <span class="op">=</span> <span class="kw">new</span> List<span class="op">&lt;</span>ModelingScenario<span class="op">&gt;();</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>        <span class="kw">while</span> <span class="op">(</span>iterator<span class="op">.</span><span class="fu">HasMoreResults</span><span class="op">)</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> response <span class="op">=</span> await iterator<span class="op">.</span><span class="fu">ReadNextAsync</span><span class="op">();</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>            results<span class="op">.</span><span class="fu">AddRange</span><span class="op">(</span>response<span class="op">);</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> results<span class="op">;</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 id="related-documents">Related Documents</h2>
<ul>
<li><a
href="01-AZURE-PEM-MASTER-PLAN.html">01-AZURE-PEM-MASTER-PLAN.md</a> -
Project overview</li>
<li><a href="05-API-DESIGN.html">05-API-DESIGN.md</a> - API
specifications using this data model</li>
<li><a href="06-INFRASTRUCTURE.html">06-INFRASTRUCTURE.md</a> - Database
provisioning with Terraform</li>
</ul>
<hr />
<p><strong>Document Status:</strong> ✅ Complete<br />
<strong>Next Steps:</strong> Review with development team, finalize JSON
schemas</p>
</body>
</html>
