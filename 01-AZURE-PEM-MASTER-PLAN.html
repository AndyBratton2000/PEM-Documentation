<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>01-AZURE-PEM-MASTER-PLAN</title>
  <style>
    /* Default styles provided by pandoc.
    ** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
    */
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
    <style>
    /* ========== FinThrive Theme Styles (Embedded) ========== */
/* Load Google Font */
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap');

body {
  font-family: 'Plus Jakarta Sans', sans-serif;
}
/* Typography Variables */
:root {
  /* Font Families */
  --font--headlines: 'Plus Jakarta Sans', sans-serif;
  --font--body-text: 'Plus Jakarta Sans', sans-serif;
  --font--accent: 'Plus Jakarta Sans', sans-serif;
  
  /* Font Weights */
  --weight--headlines: 500;
  --weight--body: normal;
  
  /* Display Sizes (Responsive) */
  --d-l: clamp(3.375rem, 4.464vi + 1.232rem, 5.250rem);
  --d-m: clamp(2.625rem, 5.060vi + 0.196rem, 4.750rem);
  --d-s: clamp(2.375rem, 2.381vi + 1.232rem, 3.375rem);
  --d-xs: clamp(2.375rem, 2.381vi + 1.232rem, 3.375rem);
  
  /* Heading Sizes (Responsive) */
  --h-xxl: clamp(2.375rem, 2.381vi + 1.232rem, 3.375rem);
  --h-xl: clamp(2.25rem, 0.893vi + 1.821rem, 2.625rem);
  --h-l: clamp(1.5rem, 1.786vi + 0.643rem, 2.250rem);
  --h-m: clamp(1.5rem, 0.595vi + 1.214rem, 1.750rem);
  --h-s: 1.3125rem;
  --h-xs: 1.125rem;
  
  /* Body Text Sizes */
  --b-l: clamp(1.25rem, 0.298vi + 1.107rem, 1.375rem);
  --b-m: 1.125rem;
  --b-s: 1.0rem;
  --b-xs: 0.875rem;
  
  /* Spacing Scale (Responsive) */
  --s-12: clamp(4.0rem, 20.238vi + -5.714rem, 12.500rem);
  --s-11: clamp(3.0rem, 16.667vi + -5.000rem, 10.000rem);
  --s-10: clamp(3.0rem, 11.905vi + -2.714rem, 8.000rem);
  --s-9: clamp(2.375rem, 8.631vi + -1.768rem, 6.000rem);
  --s-8: clamp(2.375rem, 3.869vi + 0.518rem, 4.000rem);
  --s-7: clamp(2.0rem, 2.381vi + 0.857rem, 3.000rem);
  --s-6: clamp(2.0rem, 0.595vi + 1.714rem, 2.250rem);
  --s-5: clamp(1.125rem, 0.893vi + 0.696rem, 1.500rem);
  --s-4: 1.125rem;
  --s-3: 0.75rem;
  --s-2: 0.5rem;
  --s-1: 0.25rem;
  --s-0: 0.0rem;
}

/* Light Mode Color Theme (Default) */
:root,
.light-mode {
  /* Primary Colors */
  --primary: #00E091;
  --primary--medium: #80F2C3;
  --primary--light: #C0F9E1;
  --primary--extra-light: #EBFBF7;
  --primary--dark: #005654;
  
  /* Secondary Colors */
  --secondary: #FF9B5C;
  --secondary--medium: #F87A3A;
  --secondary--light: #FFCA98;
  --secondary--extra-light: #fff2e5;
  --secondary--dark: #663E25;
  
  /* Tertiary Colors */
  --tertiary: #3E69FA;
  --tertiary--medium: #3356CC;
  --tertiary--light: #CAD6FF;
  --tertiary--dark: #13204D;
  
  /* Accent Color */
  --accent: #9efb21;
  
  /* Neutral Colors */
  --neutral--black: #005654;
  --neutral--dark: #005654;
  --neutral--medium-dark: #545757;
  --neutral--medium: #A8ABAB;
  --neutral--medium-light: #D4D6D6;
  --neutral--light: #F5F5F5;
  --neutral--white: #FFFFFF;
  
  /* Neutral Color Transparency Variants */
  --neutral--dark-80: rgba(0, 86, 84, 0.8);
  --neutral--dark-60: rgba(0, 86, 84, 0.6);
  --neutral--dark-40: rgba(0, 86, 84, 0.4);
  --neutral--dark-20: rgba(0, 86, 84, 0.2);
  --neutral--dark-10: rgba(0, 86, 84, 0.1);
  --neutral--white-80: rgba(255, 255, 255, 0.8);
  --neutral--white-60: rgba(255, 255, 255, 0.6);
  --neutral--white-40: rgba(255, 255, 255, 0.4);
  --neutral--white-20: rgba(255, 255, 255, 0.2);
  --neutral--white-10: rgba(255, 255, 255, 0.1);
  
  /* Card Styles */
  --card-border: var(--neutral--medium-light);
  --card-background-light: var(--neutral--white);
  --card-background-dark: var(--neutral--dark);
  --card-border-hover: var(--neutral--medium-dark);
  
  /* Input Styles */
  --input--border: var(--neutral--medium);
  --input--border-focused: var(--inline-links);
  --input--border-active: var(--neutral--medium-dark);
  --input--border-disabled: var(--neutral--medium-light);
  
  /* Text Colors */
  --headlines: #005654;
  --text: #005654;
  --text--80: rgba(0, 86, 84, 0.8);
  --text--60: rgba(0, 86, 84, 0.6);
  --text-input: #005654;
  
  /* UI Elements */
  --hr: var(--neutral--medium-light);
  
  /* Link Colors */
  --inline-links: #3254c8;
  --inline-links--hover: #7393FF;
  --inline-links--visited: #8C3EFA;
  --menu-links: #005654;
  --menu-links--hover: #00E091;
  --menu-links--active: #005654;
  
  /* Primary Button */
  --btn--primary-fg: var(--neutral--white);
  --btn--primary-fg-hover: var(--neutral--white);
  --btn--primary-bg: var(--primary);
  --btn--primary-bg-hover: var(--primary--medium);
  --btn--primary-stroke: var(--primary--dark);
  
  /* Secondary Button */
  --btn--secondary-fg: var(--neutral--white);
  --btn--secondary-fg-hover: var(--neutral--white);
  --btn--secondary-bg: var(--secondary);
  --btn--secondary-bg-hover: var(--secondary--medium);
  --btn--secondary-stroke: var(--neutral-dark);
  
  /* Tertiary Button */
  --btn--tertiary-fg: var(--neutral--white);
  --btn--tertiary-fg-hover: var(--neutral--white);
  --btn--tertiary-bg: var(--tertiary);
  --btn--tertiary-bg-hover: var(--tertiary--medium);
  --btn--tertiary-stroke: var(--neutral-dark);
  
  /* White Button */
  --btn--white-fg: var(--primary);
  --btn--white-fg-hover: var(--neutral--white);
  --btn--white-bg: var(--neutral--white);
  --btn--white-bg-hover: var(--primary);
  --btn--white-stroke: var(--neutral--white);
  
  color: var(--text);
}

/* Dark Mode Color Theme */
.dark-mode {
  /* Text Colors */
  --headlines: #FFFFFF;
  --text: #FFFFFF;
  --text-input: #FFFFFF;
  
  /* UI Elements */
  --hr: var(--neutral--medium-dark);
  
  /* Link Colors */
  --inline-links: #FFFFFF;
  --inline-links--hover: #70BAFE;
  --inline-links--visited: #FFFFFF;
  --menu-links: #FFFFFF;
  --menu-links--hover: #C0F9E1;
  --menu-links--active: #FFFFFF;
  
  /* Card Styles */
  --card-border: var(--neutral--white);
  --card-background-light: var(--neutral--light);
  --card-border-hover: var(--neutral--white);
  
  /* Button Strokes */
  --btn--primary-stroke: var(--neutral--white);
  --btn--secondary-stroke: var(--neutral--white);
  --btn--tertiary-stroke: var(--neutral--white);
  
  color: var(--text);
}

/* ========== Table Styles ========== */

table {
  width: 100%;
  border-collapse: collapse;
  margin: var(--s-5) 0;
  font-size: var(--b-s);
  font-family: var(--font--body-text);
  background-color: var(--neutral--white);
  border: 1px solid var(--neutral--medium-light);
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0, 86, 84, 0.08);
}

/* Table Header */
thead {
  background-color: var(--primary--extra-light);
}

thead tr {
  border-bottom: 2px solid var(--primary--medium);
}

th {
  padding: var(--s-3) var(--s-4);
  text-align: left;
  font-weight: var(--weight--headlines);
  color: var(--primary--dark);
  font-size: var(--b-s);
  letter-spacing: 0.02em;
  white-space: nowrap;
}

/* Table Body */
tbody tr {
  border-bottom: 1px solid var(--neutral--medium-light);
  transition: background-color 0.15s ease;
}

tbody tr:last-child {
  border-bottom: none;
}

/* Zebra Striping */
tbody tr:nth-child(even) {
  background-color: var(--neutral--light);
}

tbody tr:nth-child(odd) {
  background-color: var(--neutral--white);
}

/* Row Hover Effect */
tbody tr:hover {
  background-color: var(--primary--extra-light);
}

/* Table Cells */
td {
  padding: var(--s-3) var(--s-4);
  color: var(--text);
  vertical-align: top;
  line-height: 1.5;
}

/* Code in Table Cells */
td code,
th code {
  background-color: var(--neutral--light);
  padding: 0.15em 0.4em;
  border-radius: 4px;
  font-size: 0.9em;
  color: var(--tertiary--dark);
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
}

/* Bold text in first column */
td:first-child strong,
td strong {
  color: var(--primary--dark);
  font-weight: 600;
}

/* Column Groups - ensure proper column widths */
colgroup col {
  min-width: 80px;
}

/* Responsive Table Wrapper */
@media screen and (max-width: 768px) {
  table {
    display: block;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  
  th, td {
    min-width: 120px;
    padding: var(--s-2) var(--s-3);
    font-size: var(--b-xs);
  }
}

/* Dark Mode Table Styles */
.dark-mode table {
  background-color: var(--neutral--dark);
  border-color: var(--neutral--medium-dark);
}

.dark-mode thead {
  background-color: rgba(0, 224, 145, 0.15);
}

.dark-mode thead tr {
  border-bottom-color: var(--primary--medium);
}

.dark-mode th {
  color: var(--primary--medium);
}

.dark-mode tbody tr:nth-child(even) {
  background-color: rgba(255, 255, 255, 0.05);
}

.dark-mode tbody tr:nth-child(odd) {
  background-color: transparent;
}

.dark-mode tbody tr:hover {
  background-color: rgba(0, 224, 145, 0.1);
}

.dark-mode tbody tr {
  border-bottom-color: var(--neutral--medium-dark);
}

.dark-mode td {
  color: var(--text);
}

.dark-mode td code,
.dark-mode th code {
  background-color: rgba(255, 255, 255, 0.1);
  color: var(--primary--light);
}

/* ========== Additional Layout Styles ========== */

/* Body max-width and padding for readability */
body {
  max-width: 1200px;
  margin: 0 auto;
  padding: var(--s-6) var(--s-5);
  line-height: 1.6;
  background-color: var(--neutral--white);
}

/* Headings */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font--headlines);
  font-weight: var(--weight--headlines);
  color: var(--headlines);
  margin-top: var(--s-6);
  margin-bottom: var(--s-4);
  line-height: 1.3;
}

h1 {
  font-size: var(--h-xxl);
  color: var(--primary--dark);
  border-bottom: 3px solid var(--primary);
  padding-bottom: var(--s-3);
  margin-bottom: var(--s-5);
}

h2 {
  font-size: var(--h-xl);
  color: var(--primary--dark);
  border-bottom: 2px solid var(--primary--medium);
  padding-bottom: var(--s-2);
}

h3 {
  font-size: var(--h-l);
  color: var(--primary--dark);
}

h4 {
  font-size: var(--h-m);
}

h5 {
  font-size: var(--h-s);
}

h6 {
  font-size: var(--h-xs);
}

/* Horizontal Rules */
hr {
  border: none;
  border-top: 2px solid var(--hr);
  margin: var(--s-6) 0;
}

/* Paragraphs */
p {
  margin-bottom: var(--s-4);
  font-size: var(--b-m);
}

/* Links */
a {
  color: var(--inline-links);
  text-decoration: none;
  transition: color 0.15s ease;
}

a:hover {
  color: var(--inline-links--hover);
  text-decoration: underline;
}

a:visited {
  color: var(--inline-links--visited);
}

/* Blockquotes */
blockquote {
  border-left: 4px solid var(--primary);
  background-color: var(--primary--extra-light);
  padding: var(--s-4) var(--s-5);
  margin: var(--s-5) 0;
  border-radius: 0 8px 8px 0;
}

blockquote p {
  margin-bottom: 0;
}

/* Lists */
ul, ol {
  margin-bottom: var(--s-4);
  padding-left: var(--s-5);
}

li {
  margin-bottom: var(--s-2);
  line-height: 1.6;
}

/* Nested lists */
ul ul, ol ol, ul ol, ol ul {
  margin-top: var(--s-2);
  margin-bottom: 0;
}

/* Task Lists */
ul.task-list {
  list-style: none;
  padding-left: 0;
}

ul.task-list li {
  padding-left: var(--s-1);
}

/* Inline code */
code {
  background-color: var(--neutral--light);
  padding: 0.15em 0.4em;
  border-radius: 4px;
  font-size: 0.9em;
  color: var(--tertiary--dark);
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
}

/* Code blocks */
pre {
  background-color: #f8f9fa;
  color: #333333;
  border: 1px solid var(--neutral--medium-light);
  padding: var(--s-4);
  border-radius: 8px;
  overflow-x: auto;
  margin: var(--s-5) 0;
  font-size: var(--b-xs);
  line-height: 1.5;
}

pre code {
  background-color: transparent;
  padding: 0;
  color: inherit;
}

/* Mermaid diagrams */
.mermaid {
  margin: var(--s-5) 0;
  text-align: center;
  background-color: var(--neutral--white);
  padding: var(--s-4);
  border-radius: 8px;
  border: 1px solid var(--neutral--medium-light);
}
  </style>
  <!-- ========== Prism.JS Syntax Highlighting ========== -->

  <!-- Prism theme (choose one theme below) -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism.css"
  />

  <!-- Core Prism library -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>

  <!-- Add languages you need -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-csharp.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-json.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-sql.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-typescript.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-yaml.js"></script>

  <!-- Automatically highlight code after page load -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      if (window.Prism) {
        Prism.highlightAll();
      }
    });
  </script>

  <!-- ========== Mermaid Rendering ========== -->

  <!-- Use stable UMD build -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Find code blocks that came from ```mermaid fences
      const mermaidCodeBlocks = document.querySelectorAll(
        'pre.mermaid > code, pre > code.language-mermaid'
      );

      mermaidCodeBlocks.forEach(code => {
        const pre = code.parentElement;
        const parent = pre?.parentElement;
        if (!pre || !parent) return;

        const text = (code.textContent || '').trim();
        if (!text) return;

        // Replace <pre><code> with <div class="mermaid">...</div>
        const div = document.createElement('div');
        div.className = 'mermaid';
        div.textContent = text;

        parent.replaceChild(div, pre);
      });

      mermaid.initialize({
        startOnLoad: true
      });
    });
  </script>
</head>
<body>
<h1 id="prospective-episode-manager---azure-modernization">Prospective
Episode Manager - Azure Modernization</h1>
<p><strong>Version:</strong> 1.1<br />
<strong>Last Updated:</strong> January 14, 2026<br />
<strong>Author:</strong> Andy Bratton<br />
<strong>Status:</strong> Planning Phase<br />
<strong>Target Completion:</strong> End of Year 2026</p>
<blockquote>
<p><strong>Architecture Note:</strong> The PEM UI is implemented as a
<strong>new module within the existing Contract Manager Angular
application</strong> (<code>app-cm-web-app</code>). <strong>Only the
backend APIs are hosted in Azure.</strong> Users access PEM
functionality through Contract Manager, which communicates with
Azure-hosted backend services via the <code>PEM.Client</code> SDK.</p>
</blockquote>
<hr />
<h2 id="executive-summary">Executive Summary</h2>
<p>This document outlines the plan to build a <strong>modern,
Azure-based Episode-of-Care management module</strong> that will be
integrated into the on-premises Contract Manager system. The existing
PEM (Prospective Episode Manager) system serves as the functional
specification and template, but the new system will be built from the
ground up using modern technologies. Users will access Azure PEM
functionality through the Contract Manager application.</p>
<h3 id="project-vision">Project Vision</h3>
<p>Build a <strong>modern, Azure-based Episode Management
module</strong> that: - <strong>Integrates as a module within the
on-prem Contract Manager system</strong> - Leverages modern .NET
Core/.NET 10 and Azure services - Uses polyglot persistence: Azure SQL
for relational data, Azure Cosmos DB for JSON documents - Implements
cloud-native patterns for scalability and resilience - Provides seamless
user experience within Contract Managerâ€™s existing UI/workflow</p>
<hr />
<h2 id="key-principles">Key Principles</h2>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr>
<th>Principle</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Always Available</strong></td>
<td>Zone-redundant architecture with 99.99% uptime target - the system
should never be offline</td>
</tr>
<tr>
<td><strong>Extreme Performance</strong></td>
<td>Sub-second response times, optimized queries, aggressive
caching</td>
</tr>
<tr>
<td><strong>Comprehensive Observability</strong></td>
<td>Verbose logging, distributed tracing, real-time monitoring,
proactive alerting</td>
</tr>
<tr>
<td><strong>Cloud-Native Backend</strong></td>
<td>Azure services for processing, storage, and scalability</td>
</tr>
<tr>
<td><strong>Contract Manager Module</strong></td>
<td>Accessed through on-prem Contract Manager as an integrated
module</td>
</tr>
<tr>
<td><strong>PEM as Specification</strong></td>
<td>Existing PEM defines WHAT to build, not HOW</td>
</tr>
<tr>
<td><strong>Modern Stack</strong></td>
<td>.NET 10, Azure services, modern frontend components</td>
</tr>
<tr>
<td><strong>API-First</strong></td>
<td>All functionality exposed via well-designed APIs that Contract
Manager consumes</td>
</tr>
<tr>
<td><strong>Event-Driven</strong></td>
<td>Loosely coupled via Azure Service Bus</td>
</tr>
<tr>
<td><strong>Infrastructure as Code</strong></td>
<td>Terraform for all Azure resources</td>
</tr>
</tbody>
</table>
<h3 id="high-availability-commitment-production-only">High Availability
Commitment (Production Only)</h3>
<blockquote>
<p><strong>Important:</strong> High availability and zone redundancy
requirements apply <strong>only to Production</strong>. Dev, QAE, and
UAT environments use cost-optimized configurations without zone
redundancy.</p>
</blockquote>
<p><strong>Production High Availability Architecture:</strong></p>
<p><strong>PRODUCTION - 99.99% Uptime Target (Azure Region: East US
2)</strong></p>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    subgraph COMPUTE[&quot;ZONE-REDUNDANT COMPUTE&quot;]
        subgraph Z1[&quot;Zone 1&quot;]
            APP1[&quot;App Service&lt;br/&gt;Replica&quot;]
            FUNC1[&quot;Function&lt;br/&gt;Replica&quot;]
        end
        subgraph Z2[&quot;Zone 2&quot;]
            APP2[&quot;App Service&lt;br/&gt;Replica&quot;]
            FUNC2[&quot;Function&lt;br/&gt;Replica&quot;]
        end
        subgraph Z3[&quot;Zone 3&quot;]
            APP3[&quot;App Service&lt;br/&gt;Replica&quot;]
            FUNC3[&quot;Function&lt;br/&gt;Replica&quot;]
        end
    end

    subgraph DATA[&quot;ZONE-REDUNDANT DATA LAYER&quot;]
        SQL[&quot;SQL DB (ZR)&quot;]
        REDIS[&quot;Redis (ZR)&quot;]
        SB[&quot;Service Bus (ZR)&quot;]
        STORAGE[&quot;Storage (ZRS)&quot;]
    end

    Z1 --&gt; DATA
    Z2 --&gt; DATA
    Z3 --&gt; DATA</code></pre>
<p><strong>Failure Scenarios Handled:</strong> - âœ… Single zone failure
â†’ Traffic routes to remaining zones - âœ… Database failover â†’ Automatic
failover to secondary replica - âœ… App Service failure â†’ Load balancer
routes to healthy instances - âœ… Network partition â†’ Multiple
availability zones ensure connectivity</p>
<p><strong>Dev/QAE/UAT Environments (Cost-Optimized):</strong></p>
<p><strong>NON-PROD - Cost Optimized (Single Zone
Deployment)</strong></p>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    APP[&quot;App Service&lt;br/&gt;Basic/Standard&lt;br/&gt;1 instance&quot;]
    SQL[&quot;SQL DB&lt;br/&gt;General Purpose&lt;br/&gt;No ZR&quot;]
    FUNC[&quot;Functions&lt;br/&gt;Consumption&quot;]
    REDIS[&quot;Redis Basic&lt;br/&gt;No ZR&quot;]

    APP --&gt; SQL
    FUNC --&gt; SQL
    APP --&gt; REDIS</code></pre>
<p><strong>Non-Prod Acceptable:</strong> - Brief downtime during
maintenance/updates - Single point of failure (not production
traffic)</p>
<hr />
<h2 id="terminology">Terminology</h2>
<h3 id="episode-of-care-what-were-building">Episode-of-Care (What Weâ€™re
Building)</h3>
<p>An <strong>Episode-of-Care</strong> is a bundle of all healthcare
claims associated with a specific medical event, grouped for the purpose
of bundled payment pricing.</p>
<p><strong>Episode-of-Care: Hip Replacement Bundle</strong></p>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart LR
    subgraph PREOP[&quot;Pre-Op (30 days)&quot;]
        P1[&quot;â€¢ Pre-op eval&lt;br/&gt;â€¢ Lab work&lt;br/&gt;â€¢ Imaging&quot;]
    end
    subgraph PROC[&quot;Procedure (Day 0)&quot;]
        P2[&quot;â€¢ Surgery&lt;br/&gt;â€¢ Anesthesia&lt;br/&gt;â€¢ Implants&quot;]
    end
    subgraph ACUTE[&quot;Acute (3-5 days)&quot;]
        P3[&quot;â€¢ Hospital&lt;br/&gt;â€¢ Recovery&lt;br/&gt;â€¢ Nursing&quot;]
    end
    subgraph POST[&quot;Post-Acute (90 days)&quot;]
        P4[&quot;â€¢ PT/Rehab&lt;br/&gt;â€¢ Follow-ups&lt;br/&gt;â€¢ Home health&quot;]
    end

    PREOP --&gt; PROC --&gt; ACUTE --&gt; POST
    POST --&gt; PAYMENT[&quot;ğŸ’° Single Bundled Payment: $25,000&quot;]

    style PAYMENT fill:#c8e6c9,stroke:#388e3c,stroke-width:2px</code></pre>
<h3 id="common-episode-types">Common Episode Types</h3>
<table>
<thead>
<tr>
<th>Episode Type</th>
<th>Trigger</th>
<th>Typical Duration</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Maternity</strong></td>
<td>Pregnancy diagnosis</td>
<td>~10 months</td>
</tr>
<tr>
<td><strong>Joint Replacement</strong></td>
<td>Surgery CPT</td>
<td>30 days pre + 90 days post</td>
</tr>
<tr>
<td><strong>Cardiac (CABG/PCI)</strong></td>
<td>Procedure code</td>
<td>30 days pre + 90 days post</td>
</tr>
<tr>
<td><strong>Oncology</strong></td>
<td>Cancer diagnosis</td>
<td>Treatment course</td>
</tr>
<tr>
<td><strong>Transplant</strong></td>
<td>Organ transplant</td>
<td>Pre-eval + post-care</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="target-architecture">Target Architecture</h2>
<h3 id="high-level-architecture">High-Level Architecture</h3>
<p>The architecture consists of two tiers: the on-premises Contract
Manager (which hosts the PEM module UI) and the Azure cloud backend
(which provides processing and data storage).</p>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    subgraph ONPREM[&quot;ON-PREMISES&quot;]
        CM[&quot;Contract Manager Application&lt;br/&gt;(WPF/Web + PEM Module)&quot;]
    end

    subgraph AZURE[&quot;AZURE (Cloud Backend)&quot;]
        subgraph API[&quot;API LAYER&quot;]
            APIM[&quot;Azure API Management&lt;br/&gt;(Gateway, Auth, Rate Limiting)&quot;]
        end

        subgraph SERVICE[&quot;SERVICE LAYER (.NET 10)&quot;]
            EP_API[&quot;Episode API&lt;br/&gt;(App Service)&quot;]
            DEF_API[&quot;Definition API&lt;br/&gt;(App Service)&quot;]
            REP_API[&quot;Reporting API&lt;br/&gt;(App Service)&quot;]
        end

        subgraph PROCESSING[&quot;PROCESSING LAYER&quot;]
            SB[&quot;Azure Service Bus&lt;br/&gt;(Queues &amp; Topics)&quot;]
            subgraph FUNCTIONS[&quot;Azure Functions&quot;]
                EP_WORKER[&quot;Episode Worker&quot;]
                BUNDLE_WORKER[&quot;Bundle Worker&quot;]
                NOTIFY_WORKER[&quot;Notification Worker&quot;]
            end
        end

        subgraph DATA[&quot;DATA LAYER&quot;]
            SQL[&quot;Azure SQL&lt;br/&gt;(Relational)&quot;]
            COSMOS[&quot;Cosmos DB&lt;br/&gt;(JSON Docs)&quot;]
            REDIS[&quot;Azure Redis&lt;br/&gt;(Cache)&quot;]
            BLOB[&quot;Azure Blob&lt;br/&gt;(Storage)&quot;]
        end

        EG[&quot;Azure Event Grid&lt;br/&gt;(Events to CM)&quot;]
    end

    CM &lt;--&gt;|&quot;HTTPS/REST&quot;| APIM
    APIM --&gt; SERVICE
    SERVICE --&gt; SB
    SB --&gt; FUNCTIONS
    FUNCTIONS --&gt; DATA
    NOTIFY_WORKER --&gt; EG
    EG --&gt;|&quot;Webhook&quot;| CM</code></pre>
<hr />
<h2 id="technology-stack">Technology Stack</h2>
<h3 id="core-technologies">Core Technologies</h3>
<table>
<colgroup>
<col style="width: 10%" />
<col style="width: 18%" />
<col style="width: 29%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr>
<th>Layer</th>
<th>Technology</th>
<th>PROD Configuration</th>
<th>Dev/QAE/UAT Configuration</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Frontend</strong></td>
<td>Angular 19+ (module in existing CM app)</td>
<td>Deployed with Contract Manager</td>
<td>Deployed with Contract Manager</td>
</tr>
<tr>
<td><strong>Frontend Hosting</strong></td>
<td>On-prem (within Contract Manager)</td>
<td>IIS / existing CM infrastructure</td>
<td>IIS / existing CM infrastructure</td>
</tr>
<tr>
<td><strong>API Gateway</strong></td>
<td>Azure API Management</td>
<td>Premium, zone-redundant</td>
<td>Developer tier</td>
</tr>
<tr>
<td><strong>Backend APIs</strong></td>
<td>.NET 10 Minimal API</td>
<td>&lt;100ms response</td>
<td>Standard performance</td>
</tr>
<tr>
<td><strong>API Hosting</strong></td>
<td>Azure App Service</td>
<td>Premium v3, zone-redundant, 3+ instances</td>
<td>Basic/Standard, 1 instance</td>
</tr>
<tr>
<td><strong>Background Processing</strong></td>
<td>Azure Functions</td>
<td>Premium, zone-redundant</td>
<td>Consumption plan</td>
</tr>
<tr>
<td><strong>Message Queue</strong></td>
<td>Azure Service Bus</td>
<td>Premium, zone-redundant</td>
<td>Standard tier</td>
</tr>
<tr>
<td><strong>Relational Database</strong></td>
<td>Azure SQL Database</td>
<td>Business Critical, zone-redundant</td>
<td>General Purpose, no ZR</td>
</tr>
<tr>
<td><strong>Document Database</strong></td>
<td>Azure Cosmos DB (NoSQL)</td>
<td>Autoscale, zone-redundant</td>
<td>Provisioned 400 RU/s</td>
</tr>
<tr>
<td><strong>Caching</strong></td>
<td>Azure Cache for Redis</td>
<td>Premium, zone-redundant</td>
<td>Basic/Standard</td>
</tr>
<tr>
<td><strong>Real-Time</strong></td>
<td>Azure SignalR Service</td>
<td>Premium, zone-redundant</td>
<td>Free/Standard</td>
</tr>
<tr>
<td><strong>File Storage</strong></td>
<td>Azure Blob Storage</td>
<td>ZRS</td>
<td>LRS</td>
</tr>
<tr>
<td><strong>Search</strong></td>
<td>Azure Cognitive Search</td>
<td>Standard, 3 replicas</td>
<td>Basic, 1 replica</td>
</tr>
<tr>
<td><strong>Monitoring</strong></td>
<td>Application Insights</td>
<td>Full retention</td>
<td>Reduced retention</td>
</tr>
<tr>
<td><strong>Identity</strong></td>
<td>Azure AD / Entra ID</td>
<td>Microsoft-managed</td>
<td>Microsoft-managed</td>
</tr>
<tr>
<td><strong>Secrets</strong></td>
<td>Azure Key Vault</td>
<td>Standard</td>
<td>Standard</td>
</tr>
<tr>
<td><strong>Feature Flags</strong></td>
<td>Azure App Configuration</td>
<td>Standard</td>
<td>Free tier</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Production SLA Target:</strong> 99.99% (â‰ˆ52 minutes
downtime/year) <strong>Non-Production:</strong> No SLA requirements -
optimized for cost <strong>Design Philosophy:</strong> Production is
zone-redundant with no single points of failure; lower environments are
cost-optimized</p>
</blockquote>
<h3 id="worklist-ui-from-contract-manager">Worklist UI (From Contract
Manager)</h3>
<p>The Azure PEM frontend will incorporate the <strong>Contract Manager
Worklist UI patterns</strong>, which are highly valued by current
users:</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Advanced Data Grid</strong></td>
<td>Virtual scrolling, high-performance grid</td>
</tr>
<tr>
<td><strong>Column Customization</strong></td>
<td>Reorder, resize, show/hide columns</td>
</tr>
<tr>
<td><strong>Grid Filtering</strong></td>
<td>In-grid column filters with operators</td>
</tr>
<tr>
<td><strong>Criteria Builder</strong></td>
<td>Advanced search criteria panel</td>
</tr>
<tr>
<td><strong>Saved Worklists</strong></td>
<td>Save/load search configurations</td>
</tr>
<tr>
<td><strong>Shared Worklists</strong></td>
<td>Share saved worklists with team</td>
</tr>
<tr>
<td><strong>Export to CSV/Excel</strong></td>
<td>Export with column selection</td>
</tr>
<tr>
<td><strong>Sorting</strong></td>
<td>Multi-column sorting</td>
</tr>
<tr>
<td><strong>Pagination</strong></td>
<td>Configurable page sizes</td>
</tr>
<tr>
<td><strong>Real-time Updates</strong></td>
<td>SignalR for live data updates</td>
</tr>
</tbody>
</table>
<h3 id="contract-manager-angular-libraries">Contract Manager Angular
Libraries</h3>
<p>Azure PEM <strong>must use the same Angular libraries</strong> as
Contract Manager:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th>Library</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@gazelle/ng-common</code></td>
<td>Core utilities, logging, search helpers, object utilities</td>
</tr>
<tr>
<td><code>@gazelle/ng-common-ui</code></td>
<td>UI components: grid, dialogs, snackbars, criteria builder</td>
</tr>
<tr>
<td><code>@angular/material</code></td>
<td>Material Design components</td>
</tr>
<tr>
<td><code>@angular/cdk</code></td>
<td>Component Dev Kit (dialogs, overlays, virtual scroll, a11y)</td>
</tr>
<tr>
<td><code>luxon</code></td>
<td>Date/time handling (replacing moment.js)</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> These libraries are shared with Contract
Manager. Any enhancements made for PEM should be contributed back to the
shared libraries.</p>
<h3 id="development-devops">Development &amp; DevOps</h3>
<table>
<thead>
<tr>
<th>Area</th>
<th>Technology</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Source Control</strong></td>
<td>Azure DevOps / GitHub</td>
</tr>
<tr>
<td><strong>CI/CD</strong></td>
<td>Azure DevOps Pipelines / GitHub Actions</td>
</tr>
<tr>
<td><strong>Infrastructure as Code</strong></td>
<td>Terraform</td>
</tr>
<tr>
<td><strong>Containers</strong> (optional)</td>
<td>Azure Container Apps or AKS</td>
</tr>
<tr>
<td><strong>API Documentation</strong></td>
<td>OpenAPI / Swagger</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="azure-services-map">Azure Services Map</h2>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    subgraph RG[&quot;AZURE RESOURCE GROUPS&quot;]
        subgraph SHARED[&quot;rg-pem-shared-{env}&quot;]
            KV[&quot;Azure Key Vault&lt;br/&gt;(secrets, connection strings)&quot;]
            LA[&quot;Azure Log Analytics Workspace&quot;]
            AI[&quot;Application Insights&quot;]
            ACR[&quot;Azure Container Registry&lt;br/&gt;(if using containers)&quot;]
        end

        subgraph DATA[&quot;rg-pem-data-{env}&quot;]
            SQL[&quot;Azure SQL Server&quot;]
            SQLDB[&quot;â””â”€â”€ Azure SQL Database&lt;br/&gt;(pem-episodes-db)&quot;]
            COSMOS[&quot;Azure Cosmos DB Account&quot;]
            COSMOSDB[&quot;â””â”€â”€ Database: pem-documents&lt;br/&gt;(modeling, worklists, audit)&quot;]
            REDIS[&quot;Azure Cache for Redis&quot;]
            STORAGE[&quot;Azure Storage Account&lt;br/&gt;(blob, tables)&quot;]
        end

        subgraph COMPUTE[&quot;rg-pem-compute-{env}&quot;]
            ASP[&quot;Azure App Service Plan&quot;]
            API1[&quot;â”œâ”€â”€ App Service (pem-episode-api)&quot;]
            API2[&quot;â”œâ”€â”€ App Service (pem-definition-api)&quot;]
            API3[&quot;â””â”€â”€ App Service (pem-reporting-api)&quot;]
            FUNC[&quot;Azure Function App (pem-workers)&quot;]
            NOTE[&quot;Note: No Static Web App&lt;br/&gt;UI is in Contract Manager (on-prem)&quot;]
        end

        subgraph INTEGRATION[&quot;rg-pem-integration-{env}&quot;]
            SB[&quot;Azure Service Bus Namespace&quot;]
            Q1[&quot;â”œâ”€â”€ Queue: episode-processing&quot;]
            Q2[&quot;â”œâ”€â”€ Queue: bundle-calculation&quot;]
            T1[&quot;â””â”€â”€ Topic: episode-events&quot;]
            APIM[&quot;Azure API Management&quot;]
            EG[&quot;Azure Event Grid&lt;br/&gt;(for external integration)&quot;]
        end
    end</code></pre>
<hr />
<h2 id="solution-structure">Solution Structure</h2>
<h3 id="repository-strategy">Repository Strategy</h3>
<p>Azure PEM should be developed in a <strong>dedicated, isolated
repository</strong> separate from Contract Manager to enable: -
Independent release cycles - Isolated CI/CD pipelines - Clear ownership
boundaries - Autonomous deployments without impacting Contract
Manager</p>
<h4 id="recommended-repository-structure">Recommended Repository
Structure</h4>
<pre><code>Organization Repositories:
â”œâ”€â”€ azure-pem/                    # NEW - Azure backend APIs only (no frontend)
â”œâ”€â”€ contract-manager/             # EXISTING - On-prem Contract Manager (monorepo)
â”‚   â””â”€â”€ app-cm-web-app/           # PEM UI added here as new Angular module
â””â”€â”€ lib-gazelle-angular/          # EXISTING - Shared Angular libraries</code></pre>
<blockquote>
<p><strong>Key Architecture Decision:</strong> The PEM UI is a
<strong>module within the existing Contract Manager Angular app</strong>
(<code>app-cm-web-app</code>). Only the backend APIs are hosted in
Azure. This approach: - Leverages existing CM authentication and
navigation - Maintains consistent user experience - Simplifies frontend
deployment (deploys with CM) - Allows the Azure PEM backend to be
independently updated</p>
</blockquote>
<h3 id="azure-pem-repository-layout-backend-only">Azure PEM Repository
Layout (Backend Only)</h3>
<blockquote>
<p><strong>Note:</strong> This repository contains <strong>only the
Azure backend services</strong>. The PEM UI is located in the Contract
Manager repository under <code>app-cm-web-app</code>.</p>
</blockquote>
<pre><code>azure-pem/
â”‚
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci-backend.yml           # Backend CI (build, test, scan)
â”‚       â”œâ”€â”€ cd-infrastructure.yml    # Terraform apply (per environment)
â”‚       â”œâ”€â”€ cd-backend.yml           # Deploy APIs + Functions
â”‚       â””â”€â”€ cd-client-sdk.yml        # Publish PEM.Client NuGet
â”‚
â”œâ”€â”€ .azure/
â”‚   â””â”€â”€ pipelines/                   # Azure DevOps alternative
â”‚       â”œâ”€â”€ ci-backend.yml
â”‚       â”œâ”€â”€ cd-infrastructure.yml
â”‚       â”œâ”€â”€ cd-backend.yml
â”‚       â””â”€â”€ cd-client-sdk.yml
â”‚
â”œâ”€â”€ infrastructure/                   # DEPLOYABLE: Terraform IaC
â”‚   â”œâ”€â”€ terraform/
â”‚   â”‚   â”œâ”€â”€ shared-services/         # Shared infrastructure (deployed separately)
â”‚   â”‚   â”‚   â”œâ”€â”€ main.tf
â”‚   â”‚   â”‚   â”œâ”€â”€ variables.tf
â”‚   â”‚   â”‚   â”œâ”€â”€ outputs.tf
â”‚   â”‚   â”‚   â””â”€â”€ environments/
â”‚   â”‚   â”‚       â”œâ”€â”€ nonprod.tfvars   # Shared: Service Bus, SQL, Redis, KV
â”‚   â”‚   â”‚       â”œâ”€â”€ uat.tfvars       # Isolated UAT services
â”‚   â”‚   â”‚       â””â”€â”€ prod.tfvars      # Isolated Prod services
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ compute/                 # Per-environment compute (App Svc, Func, SWA)
â”‚   â”‚   â”‚   â”œâ”€â”€ main.tf
â”‚   â”‚   â”‚   â”œâ”€â”€ variables.tf
â”‚   â”‚   â”‚   â”œâ”€â”€ outputs.tf
â”‚   â”‚   â”‚   â””â”€â”€ environments/
â”‚   â”‚   â”‚       â”œâ”€â”€ dev.tfvars       # Uses shared nonprod services
â”‚   â”‚   â”‚       â”œâ”€â”€ qae.tfvars       # Uses shared nonprod services
â”‚   â”‚   â”‚       â”œâ”€â”€ uat.tfvars       # Uses isolated UAT services
â”‚   â”‚   â”‚       â””â”€â”€ prod.tfvars      # Uses isolated Prod services
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”‚   â”œâ”€â”€ networking/          # VNet, subnets, private endpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ app-service/         # App Service module
â”‚   â”‚   â”‚   â”œâ”€â”€ function-app/        # Function App module
â”‚   â”‚   â”‚   â”œâ”€â”€ signalr/             # SignalR Service module
â”‚   â”‚   â”‚   â”œâ”€â”€ sql-database/        # SQL Database module
â”‚   â”‚   â”‚   â”œâ”€â”€ service-bus/         # Service Bus module
â”‚   â”‚   â”‚   â”œâ”€â”€ redis/               # Redis Cache module
â”‚   â”‚   â”‚   â”œâ”€â”€ key-vault/           # Key Vault module
â”‚   â”‚   â”‚   â””â”€â”€ monitoring/          # App Insights, Log Analytics
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ versions.tf              # Provider versions locked
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â”œâ”€â”€ init-backend.sh          # Initialize Terraform backend
â”‚   â”‚   â””â”€â”€ deploy.sh                # Deployment helper
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ src/
â”‚   â”‚
â”‚   â”œâ”€â”€ backend/                      # DEPLOYABLE: .NET Backend Services
â”‚   â”‚   â”œâ”€â”€ PEM.sln                   # Backend-only solution
â”‚   â”‚   â”œâ”€â”€ Directory.Build.props    # Shared build properties
â”‚   â”‚   â”œâ”€â”€ Directory.Packages.props # Central package management
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ core/                     # Shared libraries (not deployed directly)
â”‚   â”‚   â”‚   â”œâ”€â”€ PEM.Domain/
â”‚   â”‚   â”‚   â”œâ”€â”€ PEM.Application/
â”‚   â”‚   â”‚   â””â”€â”€ PEM.Infrastructure/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ apis/                     # Deployable API services
â”‚   â”‚   â”‚   â”œâ”€â”€ PEM.Api.Episodes/
â”‚   â”‚   â”‚   â”œâ”€â”€ PEM.Api.Definitions/
â”‚   â”‚   â”‚   â”œâ”€â”€ PEM.Api.Modeling/
â”‚   â”‚   â”‚   â”œâ”€â”€ PEM.Api.Reporting/
â”‚   â”‚   â”‚   â”œâ”€â”€ PEM.Api.Worklist/
â”‚   â”‚   â”‚   â””â”€â”€ PEM.Api.Gateway/      # Optional: BFF for frontend
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ workers/                  # Deployable Azure Functions
â”‚   â”‚   â”‚   â””â”€â”€ PEM.Workers/
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ sdk/                      # PUBLISHABLE: NuGet package
â”‚   â”‚       â””â”€â”€ PEM.Client/           # SDK for Contract Manager integration
â”‚
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ backend/
â”‚       â”œâ”€â”€ PEM.Domain.Tests/
â”‚       â”œâ”€â”€ PEM.Application.Tests/
â”‚       â”œâ”€â”€ PEM.Api.Tests/
â”‚       â””â”€â”€ PEM.Integration.Tests/
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ architecture/
â”‚   â”œâ”€â”€ api/                          # OpenAPI specs
â”‚   â””â”€â”€ runbooks/                     # Operational runbooks
â”‚
â”œâ”€â”€ .editorconfig
â”œâ”€â”€ .gitignore
â”œâ”€â”€ .prettierrc
â”œâ”€â”€ README.md
â”œâ”€â”€ CHANGELOG.md
â””â”€â”€ VERSION                           # Semantic version file</code></pre>
<h3 id="pem-ui-location-in-contract-manager-repository">PEM UI Location
(in Contract Manager Repository)</h3>
<p>The PEM frontend is a <strong>new Angular module within the existing
Contract Manager application</strong> (<code>app-cm-web-app</code>).
This is NOT a separate application.</p>
<pre><code>contract-manager/                        # EXISTING Contract Manager monorepo
â””â”€â”€ app-cm-web-app/
    â””â”€â”€ cm-web-app/
        â””â”€â”€ projects/
            â””â”€â”€ cm-web-app/
                â””â”€â”€ src/
                    â””â”€â”€ app/
                        â”œâ”€â”€ ... (existing modules: admin, medicare, worklist, etc.)
                        â”‚
                        â””â”€â”€ pem/                    # NEW - PEM Module (added to CM)
                            â”œâ”€â”€ pem.module.ts
                            â”œâ”€â”€ pem-routing.module.ts
                            â”‚
                            â”œâ”€â”€ episodes/           # Episode management
                            â”‚   â”œâ”€â”€ episodes.module.ts
                            â”‚   â”œâ”€â”€ episode-list/
                            â”‚   â”œâ”€â”€ episode-detail/
                            â”‚   â””â”€â”€ episode-search/
                            â”‚
                            â”œâ”€â”€ definitions/        # Episode definition management
                            â”‚   â”œâ”€â”€ definitions.module.ts
                            â”‚   â”œâ”€â”€ definition-list/
                            â”‚   â”œâ”€â”€ definition-builder/
                            â”‚   â””â”€â”€ definition-versioning/
                            â”‚
                            â”œâ”€â”€ modeling/           # Contract-based modeling
                            â”‚   â”œâ”€â”€ modeling.module.ts
                            â”‚   â”œâ”€â”€ scenario-builder/
                            â”‚   â”œâ”€â”€ contract-comparison/
                            â”‚   â””â”€â”€ what-if-analysis/
                            â”‚
                            â”œâ”€â”€ pem-worklist/       # PEM-specific worklist (extends CM pattern)
                            â”‚   â”œâ”€â”€ pem-worklist.module.ts
                            â”‚   â”œâ”€â”€ pem-worklist-criteria/
                            â”‚   â””â”€â”€ pem-worklist-grid/
                            â”‚
                            â”œâ”€â”€ reports/            # PEM reports and dashboards
                            â”‚   â”œâ”€â”€ reports.module.ts
                            â”‚   â”œâ”€â”€ episode-summary/
                            â”‚   â””â”€â”€ bundle-analysis/
                            â”‚
                            â””â”€â”€ shared/             # PEM-specific shared components
                                â”œâ”€â”€ pem-api.service.ts      # Calls Azure PEM APIs
                                â”œâ”€â”€ pem-signalr.service.ts  # Real-time updates
                                â””â”€â”€ models/                  # PEM-specific models</code></pre>
<p><strong>Integration Points with Contract Manager:</strong></p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 66%" />
</colgroup>
<thead>
<tr>
<th>Aspect</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Navigation</strong></td>
<td>PEM added to CM main menu/sidebar via existing navigation
system</td>
</tr>
<tr>
<td><strong>Authentication</strong></td>
<td>Uses CMâ€™s existing <code>AuthService</code> and Azure AD
integration</td>
</tr>
<tr>
<td><strong>Authorization</strong></td>
<td>New PEM permissions added to CMâ€™s permission system</td>
</tr>
<tr>
<td><strong>Shared Services</strong></td>
<td>Reuses CMâ€™s <code>@gazelle/ng-common</code> utilities, logging,
error handling</td>
</tr>
<tr>
<td><strong>Lazy Loading</strong></td>
<td>PEM module lazy-loaded via Angular router for performance</td>
</tr>
<tr>
<td><strong>API Calls</strong></td>
<td><code>pem-api.service.ts</code> calls Azure-hosted PEM APIs via
<code>PEM.Client</code> patterns</td>
</tr>
</tbody>
</table>
<p><strong>Deployment:</strong> The PEM UI deploys with Contract Manager
(not separately). When CM is deployed, the PEM module is included.</p>
<h3 id="cicd-pipeline-strategy-azure-devops">CI/CD Pipeline Strategy
(Azure DevOps)</h3>
<p>Deployments follow a <strong>progressive promotion</strong> through
environments:</p>
<p><strong>CI/CD Pipeline</strong></p>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    subgraph BUILD[&quot;BUILD STAGE&quot;]
        CI[&quot;CI: Build â†’ Test â†’ Scan â†’ Publish Artifacts&quot;]
    end

    subgraph DEPLOY[&quot;DEPLOYMENT STAGES&quot;]
        DEV[&quot;DEV&lt;br/&gt;Auto Deploy&lt;br/&gt;Shared Services (nonprod)&quot;]
        QAE[&quot;QAE&lt;br/&gt;Manual QA Pull&lt;br/&gt;Shared Services (nonprod)&quot;]
        UAT[&quot;UAT&lt;br/&gt;Manual Approve&lt;br/&gt;Isolated Services (uat)&quot;]
        PROD[&quot;PROD&lt;br/&gt;Manual Approve&lt;br/&gt;Isolated Services (prod)&quot;]
    end

    subgraph ARTIFACTS[&quot;ARTIFACTS&quot;]
        SDK[&quot;PEM.Client SDK â†’ NuGet Feed â†’ Contract Manager (consumes)&quot;]
    end

    CI --&gt; DEV
    DEV --&gt;|&quot;QG âœ…&quot;| QAE
    QAE --&gt;|&quot;IT âœ…&quot;| UAT
    UAT --&gt;|&quot;E2E âœ…&quot;| PROD</code></pre>
<p><strong>Deployment Gates:</strong></p>
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 17%" />
<col style="width: 19%" />
<col style="width: 26%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr>
<th>Stage</th>
<th>Trigger</th>
<th>Approval</th>
<th>Quality Gate</th>
<th>Validation</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DEV</strong></td>
<td>Automatic on merge to <code>main</code></td>
<td>None</td>
<td>âœ… 100% code coverage, all tests pass</td>
<td>Smoke tests</td>
</tr>
<tr>
<td><strong>QAE</strong></td>
<td>Manual trigger (QA pull)</td>
<td>QA representative</td>
<td>Must pass DEV quality gate</td>
<td>Integration tests</td>
</tr>
<tr>
<td><strong>UAT</strong></td>
<td>Manual trigger</td>
<td>QA Lead approval</td>
<td>Must pass QAE validation</td>
<td>E2E tests, UAT signoff</td>
</tr>
<tr>
<td><strong>PROD</strong></td>
<td>Manual trigger</td>
<td>Release Manager + PO approval</td>
<td>Must pass UAT signoff</td>
<td>Smoke tests, monitoring</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> QAE is a manual â€œpullâ€ deployment - QA decides
when they are ready to receive new changes. This prevents unexpected
changes from disrupting active QA testing cycles.</p>
</blockquote>
<h3 id="quality-gates-mandatory">Quality Gates (Mandatory)</h3>
<p>Code <strong>cannot leave DEV</strong> unless it passes all quality
gates. These are enforced automatically in the CI/CD pipeline.</p>
<p><strong>Quality Gates</strong></p>
<table>
<thead>
<tr>
<th>Gate</th>
<th>Requirements</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>BEFORE MERGE TO MAIN (PR Gate)</strong></td>
<td>âœ“ All unit tests pass</td>
</tr>
<tr>
<td></td>
<td>âœ“ All integration tests pass</td>
</tr>
<tr>
<td></td>
<td>âœ“ Code coverage â‰¥ 100%</td>
</tr>
<tr>
<td></td>
<td>âœ“ No critical/high vulnerabilities</td>
</tr>
<tr>
<td></td>
<td>âœ“ Code review approved</td>
</tr>
<tr>
<td></td>
<td>âœ“ Linting passes</td>
</tr>
<tr>
<td></td>
<td>âœ“ Build succeeds</td>
</tr>
<tr>
<td><strong>BEFORE LEAVING DEV (Deployment Gate)</strong></td>
<td>âœ“ Smoke tests pass</td>
</tr>
<tr>
<td></td>
<td>âœ“ Health checks pass</td>
</tr>
<tr>
<td></td>
<td>âœ“ No P1/P2 bugs</td>
</tr>
<tr>
<td><strong>Result</strong></td>
<td>âœ… ELIGIBLE FOR QAE (QA must approve)</td>
</tr>
</tbody>
</table>
<p><strong>Quality Gate Enforcement:</strong></p>
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 23%" />
<col style="width: 28%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th>Gate</th>
<th>Threshold</th>
<th>Enforcement</th>
<th>Failure Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Code Coverage (Lines)</strong></td>
<td>100%</td>
<td>Pipeline fails</td>
<td>Block merge/deployment</td>
</tr>
<tr>
<td><strong>Code Coverage (Branches)</strong></td>
<td>100%</td>
<td>Pipeline fails</td>
<td>Block merge/deployment</td>
</tr>
<tr>
<td><strong>Unit Tests</strong></td>
<td>100% pass</td>
<td>Pipeline fails</td>
<td>Block merge/deployment</td>
</tr>
<tr>
<td><strong>Integration Tests</strong></td>
<td>100% pass</td>
<td>Pipeline fails</td>
<td>Block merge/deployment</td>
</tr>
<tr>
<td><strong>Security Scan (SAST)</strong></td>
<td>No critical/high</td>
<td>Pipeline fails</td>
<td>Block merge/deployment</td>
</tr>
<tr>
<td><strong>Dependency Scan</strong></td>
<td>No critical CVEs</td>
<td>Pipeline fails</td>
<td>Block merge/deployment</td>
</tr>
<tr>
<td><strong>Linting</strong></td>
<td>No errors</td>
<td>Pipeline fails</td>
<td>Block merge/deployment</td>
</tr>
<tr>
<td><strong>Build</strong></td>
<td>Success</td>
<td>Pipeline fails</td>
<td>Block merge/deployment</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Zero Tolerance Policy:</strong> If any quality gate fails,
the code cannot proceed. There are no exceptions or overrides for
coverage or test failures.</p>
</blockquote>
<p><strong>Azure DevOps Environment Approval Configuration:</strong></p>
<table>
<colgroup>
<col style="width: 27%" />
<col style="width: 23%" />
<col style="width: 19%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr>
<th>Environment</th>
<th>Approvers</th>
<th>Timeout</th>
<th>Instructions</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pem-dev</code></td>
<td>None</td>
<td>N/A</td>
<td>Auto-deploy after build succeeds</td>
</tr>
<tr>
<td><code>pem-qae</code></td>
<td>QA Representatives group</td>
<td>7 days</td>
<td>â€œApprove when ready to receive new changes. Check DEV testing
results first.â€</td>
</tr>
<tr>
<td><code>pem-uat</code></td>
<td>QA Lead</td>
<td>30 days</td>
<td>â€œApprove after QAE testing complete and regression passed.â€</td>
</tr>
<tr>
<td><code>pem-prod</code></td>
<td>Release Manager, Product Owner</td>
<td>30 days</td>
<td>â€œApprove after UAT sign-off and release notes prepared.â€</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Setup:</strong> In Azure DevOps â†’ Pipelines â†’ Environments â†’
Select environment â†’ Approvals and checks â†’ Add â€œApprovalsâ€ check with
appropriate approvers.</p>
</blockquote>
<h3 id="ado-multi-stage-pipeline">ADO Multi-Stage Pipeline</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># azure-pipelines.yml</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">trigger</span><span class="kw">:</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">branches</span><span class="kw">:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">include</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">main</span><span class="kw">]</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">include</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">src/backend/</span><span class="ot">**,</span><span class="at"> src/frontend/</span><span class="ot">**]</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">stages</span><span class="kw">:</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">  # BUILD STAGE</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="at">  - </span><span class="fu">stage</span><span class="kw">:</span><span class="at"> Build</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="at">    jobs:</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="at">      - job: BuildBackend</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="at">        steps: [restore</span><span class="kw">,</span><span class="at"> build</span><span class="kw">,</span><span class="at"> test</span><span class="kw">,</span><span class="at"> publish</span><span class="kw">]</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">job</span><span class="kw">:</span><span class="at"> BuildFrontend</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">steps</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">npm ci</span><span class="kw">,</span><span class="at"> lint</span><span class="kw">,</span><span class="at"> test</span><span class="kw">,</span><span class="at"> build</span><span class="kw">,</span><span class="at"> publish</span><span class="kw">]</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">  # DEV DEPLOYMENT (Auto) - Uses shared nonprod services</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">stage</span><span class="kw">:</span><span class="at"> DeployDev</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">dependsOn</span><span class="kw">:</span><span class="at"> Build</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">condition</span><span class="kw">:</span><span class="at"> succeeded()</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">group</span><span class="kw">:</span><span class="at"> pem-dev-variables</span><span class="co">      # Points to shared nonprod services</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">deployment</span><span class="kw">:</span><span class="at"> DeployApis</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">environment</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;pem-dev&#39;</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">strategy</span><span class="kw">:</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">runOnce</span><span class="kw">:</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">deploy</span><span class="kw">:</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">steps</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">deploy-apis</span><span class="kw">,</span><span class="at"> deploy-functions</span><span class="kw">,</span><span class="at"> deploy-spa</span><span class="kw">]</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">job</span><span class="kw">:</span><span class="at"> SmokeTests</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">dependsOn</span><span class="kw">:</span><span class="at"> DeployApis</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">steps</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">run-smoke-tests</span><span class="kw">]</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co">  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co">  # QAE DEPLOYMENT (Manual QA pull) - Uses shared nonprod services</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co">  # QA representative must approve before deployment proceeds</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co">  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">stage</span><span class="kw">:</span><span class="at"> DeployQae</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">dependsOn</span><span class="kw">:</span><span class="at"> DeployDev</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">condition</span><span class="kw">:</span><span class="at"> succeeded()</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">group</span><span class="kw">:</span><span class="at"> pem-qae-variables</span><span class="co">      # Points to shared nonprod services</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">deployment</span><span class="kw">:</span><span class="at"> DeployApis</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">environment</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;pem-qae&#39;</span><span class="co">        # Approval gate configured in ADO (QA pull)</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">strategy</span><span class="kw">:</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">runOnce</span><span class="kw">:</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">deploy</span><span class="kw">:</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">steps</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">deploy-apis</span><span class="kw">,</span><span class="at"> deploy-functions</span><span class="kw">,</span><span class="at"> deploy-spa</span><span class="kw">]</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">job</span><span class="kw">:</span><span class="at"> IntegrationTests</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">dependsOn</span><span class="kw">:</span><span class="at"> DeployApis</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">steps</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">run-integration-tests</span><span class="kw">]</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="co">  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co">  # UAT DEPLOYMENT (Manual approval) - Isolated services</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="co">  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">stage</span><span class="kw">:</span><span class="at"> DeployUat</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">dependsOn</span><span class="kw">:</span><span class="at"> DeployQae</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">condition</span><span class="kw">:</span><span class="at"> succeeded()</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">group</span><span class="kw">:</span><span class="at"> pem-uat-variables</span><span class="co">      # Points to isolated UAT services</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">deployment</span><span class="kw">:</span><span class="at"> DeployApis</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">environment</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;pem-uat&#39;</span><span class="co">        # Approval gate configured in ADO</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">strategy</span><span class="kw">:</span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">runOnce</span><span class="kw">:</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">deploy</span><span class="kw">:</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">steps</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">deploy-apis</span><span class="kw">,</span><span class="at"> deploy-functions</span><span class="kw">,</span><span class="at"> deploy-spa</span><span class="kw">]</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">job</span><span class="kw">:</span><span class="at"> E2ETests</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">dependsOn</span><span class="kw">:</span><span class="at"> DeployApis</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">steps</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">run-e2e-tests</span><span class="kw">]</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="co">  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="co">  # PROD DEPLOYMENT (Manual approval) - Isolated services</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a><span class="co">  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">stage</span><span class="kw">:</span><span class="at"> DeployProd</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">dependsOn</span><span class="kw">:</span><span class="at"> DeployUat</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">condition</span><span class="kw">:</span><span class="at"> succeeded()</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">group</span><span class="kw">:</span><span class="at"> pem-prod-variables</span><span class="co">     # Points to isolated prod services</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">deployment</span><span class="kw">:</span><span class="at"> DeployApis</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">environment</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;pem-prod&#39;</span><span class="co">       # Approval gate configured in ADO</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">strategy</span><span class="kw">:</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">runOnce</span><span class="kw">:</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">deploy</span><span class="kw">:</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">steps</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">deploy-apis</span><span class="kw">,</span><span class="at"> deploy-functions</span><span class="kw">,</span><span class="at"> deploy-spa</span><span class="kw">]</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">job</span><span class="kw">:</span><span class="at"> ProductionValidation</span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">dependsOn</span><span class="kw">:</span><span class="at"> DeployApis</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">steps</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">run-smoke-tests</span><span class="kw">,</span><span class="at"> verify-monitoring</span><span class="kw">]</span></span></code></pre></div>
<h3 id="variable-groups-configuration">Variable Groups
Configuration</h3>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 15%" />
<col style="width: 13%" />
<col style="width: 8%" />
<col style="width: 12%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr>
<th>Variable Group</th>
<th>Service Bus</th>
<th>SQL Server</th>
<th>Redis</th>
<th>Key Vault</th>
<th>App Config (Feature Flags)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pem-dev-variables</code></td>
<td><code>pem-sb-nonprod</code></td>
<td><code>pem-sql-nonprod</code> (db: dev)</td>
<td><code>pem-redis-nonprod</code></td>
<td><code>pem-kv-nonprod</code></td>
<td><code>pem-appconfig-nonprod</code></td>
</tr>
<tr>
<td><code>pem-qae-variables</code></td>
<td><code>pem-sb-nonprod</code></td>
<td><code>pem-sql-nonprod</code> (db: qae)</td>
<td><code>pem-redis-nonprod</code></td>
<td><code>pem-kv-nonprod</code></td>
<td><code>pem-appconfig-nonprod</code></td>
</tr>
<tr>
<td><code>pem-uat-variables</code></td>
<td><code>pem-sb-uat</code></td>
<td><code>pem-sql-uat</code></td>
<td><code>pem-redis-uat</code></td>
<td><code>pem-kv-uat</code></td>
<td><code>pem-appconfig-uat</code></td>
</tr>
<tr>
<td><code>pem-prod-variables</code></td>
<td><code>pem-sb-prod</code></td>
<td><code>pem-sql-prod</code></td>
<td><code>pem-redis-prod</code></td>
<td><code>pem-kv-prod</code></td>
<td><code>pem-appconfig-prod</code></td>
</tr>
</tbody>
</table>
<h3 id="deployment-independence">Deployment Independence</h3>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 15%" />
<col style="width: 22%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr>
<th>Component</th>
<th>Trigger</th>
<th>Progression</th>
<th>Can Deploy Independently</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Shared Services (nonprod)</strong></td>
<td>Manual</td>
<td>N/A (one-time setup)</td>
<td>âœ… Yes</td>
</tr>
<tr>
<td><strong>Shared Services (uat)</strong></td>
<td>Manual</td>
<td>N/A (one-time setup)</td>
<td>âœ… Yes</td>
</tr>
<tr>
<td><strong>Shared Services (prod)</strong></td>
<td>Manual</td>
<td>N/A (one-time setup)</td>
<td>âœ… Yes</td>
</tr>
<tr>
<td><strong>Compute (all envs)</strong></td>
<td><code>infrastructure/compute/**</code></td>
<td>dev â†’ qae â†’ uat â†’ prod</td>
<td>âœ… Yes</td>
</tr>
<tr>
<td><strong>Backend APIs</strong></td>
<td><code>src/backend/**</code> changes</td>
<td>dev â†’ qae â†’ uat â†’ prod</td>
<td>âœ… Yes</td>
</tr>
<tr>
<td><strong>Azure Functions</strong></td>
<td><code>src/backend/workers/**</code> changes</td>
<td>dev â†’ qae â†’ uat â†’ prod</td>
<td>âœ… Yes</td>
</tr>
<tr>
<td><strong>PEM.Client SDK</strong></td>
<td><code>src/backend/sdk/**</code> + manual</td>
<td>N/A (NuGet publish)</td>
<td>âœ… Yes</td>
</tr>
<tr>
<td><strong>PEM UI (Frontend)</strong></td>
<td><code>contract-manager/app-cm-web-app/</code></td>
<td>Deploys with Contract Manager</td>
<td>Via CM pipeline</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> The PEM UI is part of the Contract Manager
Angular app and deploys through the existing CM pipeline, not the Azure
PEM pipeline.</p>
</blockquote>
<h3 id="versioning-strategy">Versioning Strategy</h3>
<pre><code>azure-pem/
â”œâ”€â”€ VERSION                    # e.g., 1.2.3 (backend only)
â”œâ”€â”€ src/
â”‚   â””â”€â”€ backend/
â”‚       â””â”€â”€ Directory.Build.props   # Reads VERSION for assembly version

# PEM UI version is tied to Contract Manager version
contract-manager/
â””â”€â”€ app-cm-web-app/
    â””â”€â”€ cm-web-app/
        â””â”€â”€ package.json              # CM version includes PEM module</code></pre>
<p><strong>Semantic Versioning:</strong> - <code>MAJOR</code> - Breaking
API changes - <code>MINOR</code> - New features, backward compatible -
<code>PATCH</code> - Bug fixes</p>
<p><strong>Version Sync:</strong> CI pipeline reads <code>VERSION</code>
file and applies to all artifacts.</p>
<hr />
<h3 id="feature-flags-and-release-management">Feature Flags and Release
Management</h3>
<h4 id="deployment-vs-release-separation">Deployment vs Release
Separation</h4>
<p>A core principle of this project is that <strong>Deployments â‰ 
Releases</strong>:</p>
<table>
<colgroup>
<col style="width: 27%" />
<col style="width: 45%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr>
<th>Concept</th>
<th>Controlled By</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Deployment</strong></td>
<td>Engineering Team</td>
<td>Move code to an environment (may be behind feature flags)</td>
</tr>
<tr>
<td><strong>Release</strong></td>
<td>Product Owners</td>
<td>Enable features for users by toggling flags</td>
</tr>
</tbody>
</table>
<p><strong>Deployment vs Release (Feature Flags)</strong></p>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    subgraph ENGINEERING[&quot;ENGINEERING CONTROLS DEPLOYMENT&quot;]
        COMMIT[&quot;Code Commit&quot;] --&gt; BUILD[&quot;Build&quot;]
        BUILD --&gt; DEV[&quot;Deploy DEV&lt;br/&gt;(feature OFF)&quot;]
        DEV --&gt; QAE[&quot;Deploy QAE&lt;br/&gt;(feature OFF)&quot;]
        QAE --&gt; UAT[&quot;Deploy UAT&lt;br/&gt;(feature OFF)&quot;]
        UAT --&gt; PROD[&quot;Deploy PROD&lt;br/&gt;(feature OFF)&quot;]
    end

    PROD --&gt;|&quot;Code deployed but hidden&quot;| RELEASE

    subgraph RELEASE[&quot;PRODUCT OWNER CONTROLS RELEASE&quot;]
        direction LR
        TOGGLE[&quot;Toggle Feature Flag&lt;br/&gt;(Azure App Configuration)&quot;]
        FA[&quot;Feature A&lt;br/&gt;âœ… Released (100%)&quot;]
        FB[&quot;Feature B&lt;br/&gt;ğŸ”’ Beta (10% users)&quot;]
        FC[&quot;Feature C&lt;br/&gt;âŒ Hidden (0%)&quot;]
    end</code></pre>
<h4 id="azure-app-configuration-feature-management">Azure App
Configuration Feature Management</h4>
<p><strong>Infrastructure (Terraform):</strong></p>
<table>
<thead>
<tr>
<th>Resource</th>
<th>Naming</th>
<th>Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Azure App Configuration</td>
<td><code>appconfig-pem-nonprod</code></td>
<td>Shared: dev, qae</td>
</tr>
<tr>
<td>Azure App Configuration</td>
<td><code>appconfig-pem-uat</code></td>
<td>Isolated: uat</td>
</tr>
<tr>
<td>Azure App Configuration</td>
<td><code>appconfig-pem-prod</code></td>
<td>Isolated: prod</td>
</tr>
</tbody>
</table>
<p><strong>Feature Flag Naming Convention:</strong></p>
<pre><code>PEM.[FeatureArea].[FeatureName]

Examples:
- PEM.Modeling.ContractComparison
- PEM.Worklist.AdvancedFilters
- PEM.Episodes.BulkOperations
- PEM.Reporting.CustomReports
- PEM.Integration.ClaimShopV2</code></pre>
<p><strong>Feature Flag Metadata:</strong></p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Label</code></td>
<td>Environment (dev, qae, uat, prod)</td>
</tr>
<tr>
<td><code>Description</code></td>
<td>Human-readable feature description</td>
</tr>
<tr>
<td><code>Owner</code></td>
<td>Product owner responsible for release</td>
</tr>
<tr>
<td><code>Created</code></td>
<td>Date flag was created</td>
</tr>
<tr>
<td><code>TargetRelease</code></td>
<td>Planned release version</td>
</tr>
</tbody>
</table>
<h4 id="net-backend-implementation">.NET Backend Implementation</h4>
<p><strong>Package Installation:</strong></p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode xml"><code class="sourceCode xml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">PackageReference</span> <span class="ot">Include=</span><span class="st">&quot;Microsoft.Azure.AppConfiguration.AspNetCore&quot;</span> <span class="ot">Version=</span><span class="st">&quot;7.*&quot;</span> /&gt;</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">PackageReference</span> <span class="ot">Include=</span><span class="st">&quot;Microsoft.FeatureManagement.AspNetCore&quot;</span> <span class="ot">Version=</span><span class="st">&quot;3.*&quot;</span> /&gt;</span></code></pre></div>
<p><strong>Configuration (Program.cs):</strong></p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode csharp"><code class="sourceCode cs"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> builder <span class="op">=</span> WebApplication<span class="op">.</span><span class="fu">CreateBuilder</span><span class="op">(</span>args<span class="op">);</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Connect to Azure App Configuration with feature flags</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>builder<span class="op">.</span><span class="fu">Configuration</span><span class="op">.</span><span class="fu">AddAzureAppConfiguration</span><span class="op">(</span>options <span class="op">=&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    options<span class="op">.</span><span class="fu">Connect</span><span class="op">(</span>builder<span class="op">.</span><span class="fu">Configuration</span><span class="op">[</span><span class="st">&quot;AppConfig:ConnectionString&quot;</span><span class="op">])</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>           <span class="op">.</span><span class="fu">Select</span><span class="op">(</span>KeyFilter<span class="op">.</span><span class="fu">Any</span><span class="op">,</span> LabelFilter<span class="op">.</span><span class="fu">Null</span><span class="op">)</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>           <span class="op">.</span><span class="fu">Select</span><span class="op">(</span>KeyFilter<span class="op">.</span><span class="fu">Any</span><span class="op">,</span> builder<span class="op">.</span><span class="fu">Environment</span><span class="op">.</span><span class="fu">EnvironmentName</span><span class="op">)</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>           <span class="op">.</span><span class="fu">UseFeatureFlags</span><span class="op">(</span>featureOptions <span class="op">=&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>           <span class="op">{</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>               featureOptions<span class="op">.</span><span class="fu">Label</span> <span class="op">=</span> builder<span class="op">.</span><span class="fu">Environment</span><span class="op">.</span><span class="fu">EnvironmentName</span><span class="op">;</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>               featureOptions<span class="op">.</span><span class="fu">CacheExpirationInterval</span> <span class="op">=</span> TimeSpan<span class="op">.</span><span class="fu">FromSeconds</span><span class="op">(</span><span class="dv">30</span><span class="op">);</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>           <span class="op">});</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Add feature management</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>builder<span class="op">.</span><span class="fu">Services</span><span class="op">.</span><span class="fu">AddFeatureManagement</span><span class="op">();</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>builder<span class="op">.</span><span class="fu">Services</span><span class="op">.</span><span class="fu">AddAzureAppConfiguration</span><span class="op">();</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> app <span class="op">=</span> builder<span class="op">.</span><span class="fu">Build</span><span class="op">();</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">// Enable dynamic configuration refresh</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>app<span class="op">.</span><span class="fu">UseAzureAppConfiguration</span><span class="op">();</span></span></code></pre></div>
<p><strong>Usage in APIs:</strong></p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode csharp"><code class="sourceCode cs"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Controller/Endpoint level</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="fu">FeatureGate</span><span class="op">(</span><span class="st">&quot;PEM.Modeling.ContractComparison&quot;</span><span class="op">)]</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> async Task<span class="op">&lt;</span>IActionResult<span class="op">&gt;</span> <span class="fu">CompareContracts</span><span class="op">(</span>CompareContractsRequest request<span class="op">)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Only accessible when feature is enabled</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Service level with IFeatureManager</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ModelingService</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">readonly</span> IFeatureManager _featureManager<span class="op">;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>ModelingResult<span class="op">&gt;</span> <span class="fu">ProcessScenario</span><span class="op">(</span>Scenario scenario<span class="op">)</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>await _featureManager<span class="op">.</span><span class="fu">IsEnabledAsync</span><span class="op">(</span><span class="st">&quot;PEM.Modeling.AdvancedRebundling&quot;</span><span class="op">))</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> await <span class="fu">ProcessWithAdvancedRebundling</span><span class="op">(</span>scenario<span class="op">);</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> await <span class="fu">ProcessStandard</span><span class="op">(</span>scenario<span class="op">);</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="angular-frontend-implementation">Angular Frontend
Implementation</h4>
<p><strong>Feature Flag Service:</strong></p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">// feature-flag.service.ts</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Injectable } <span class="im">from</span> <span class="st">&#39;@angular/core&#39;</span><span class="op">;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { HttpClient } <span class="im">from</span> <span class="st">&#39;@angular/common/http&#39;</span><span class="op">;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { BehaviorSubject<span class="op">,</span> Observable<span class="op">,</span> interval } <span class="im">from</span> <span class="st">&#39;rxjs&#39;</span><span class="op">;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { switchMap<span class="op">,</span> shareReplay } <span class="im">from</span> <span class="st">&#39;rxjs/operators&#39;</span><span class="op">;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="kw">interface</span> FeatureFlags {</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  [key<span class="op">:</span> <span class="dt">string</span>]<span class="op">:</span> <span class="dt">boolean</span><span class="op">;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>@<span class="fu">Injectable</span>({ providedIn<span class="op">:</span> <span class="st">&#39;root&#39;</span> })</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> FeatureFlagService {</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> flags$ <span class="op">=</span> <span class="kw">new</span> <span class="fu">BehaviorSubject</span><span class="op">&lt;</span>FeatureFlags<span class="op">&gt;</span>({})<span class="op">;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> refreshInterval <span class="op">=</span> <span class="dv">30000</span><span class="op">;</span> <span class="co">// 30 seconds</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constructor</span>(<span class="kw">private</span> http<span class="op">:</span> HttpClient) {</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">initializeFlags</span>()<span class="op">;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> <span class="fu">initializeFlags</span>()<span class="op">:</span> <span class="dt">void</span> {</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initial load + periodic refresh</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">loadFlags</span>()<span class="op">;</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">interval</span>(<span class="kw">this</span><span class="op">.</span><span class="at">refreshInterval</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">pipe</span>(<span class="fu">switchMap</span>(() <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">fetchFlags</span>()))</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">subscribe</span>(flags <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">flags$</span><span class="op">.</span><span class="fu">next</span>(flags))<span class="op">;</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> <span class="fu">fetchFlags</span>()<span class="op">:</span> Observable<span class="op">&lt;</span>FeatureFlags<span class="op">&gt;</span> {</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">http</span><span class="op">.</span><span class="fu">get</span><span class="op">&lt;</span>FeatureFlags<span class="op">&gt;</span>(<span class="st">&#39;/api/features&#39;</span>)<span class="op">;</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">isEnabled</span>(featureName<span class="op">:</span> <span class="dt">string</span>)<span class="op">:</span> Observable<span class="op">&lt;</span><span class="dt">boolean</span><span class="op">&gt;</span> {</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">flags$</span><span class="op">.</span><span class="fu">pipe</span>(</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map</span>(flags <span class="kw">=&gt;</span> flags[featureName] <span class="op">??</span> <span class="kw">false</span>)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">isEnabledSync</span>(featureName<span class="op">:</span> <span class="dt">string</span>)<span class="op">:</span> <span class="dt">boolean</span> {</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">flags$</span><span class="op">.</span><span class="at">value</span>[featureName] <span class="op">??</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Feature Flag Directive:</strong></p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">// feature-flag.directive.ts</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Directive<span class="op">,</span> Input<span class="op">,</span> TemplateRef<span class="op">,</span> ViewContainerRef } <span class="im">from</span> <span class="st">&#39;@angular/core&#39;</span><span class="op">;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { FeatureFlagService } <span class="im">from</span> <span class="st">&#39;./feature-flag.service&#39;</span><span class="op">;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>@<span class="fu">Directive</span>({ selector<span class="op">:</span> <span class="st">&#39;[pemFeatureFlag]&#39;</span> })</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> FeatureFlagDirective {</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  @<span class="fu">Input</span>() <span class="kw">set</span> <span class="fu">pemFeatureFlag</span>(featureName<span class="op">:</span> <span class="dt">string</span>) {</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">featureFlagService</span><span class="op">.</span><span class="fu">isEnabled</span>(featureName)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">pipe</span>(<span class="fu">takeUntilDestroyed</span>(<span class="kw">this</span><span class="op">.</span><span class="at">destroyRef</span>))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">subscribe</span>(enabled <span class="kw">=&gt;</span> {</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">viewContainer</span><span class="op">.</span><span class="fu">clear</span>()<span class="op">;</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (enabled) {</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">viewContainer</span><span class="op">.</span><span class="fu">createEmbeddedView</span>(<span class="kw">this</span><span class="op">.</span><span class="at">templateRef</span>)<span class="op">;</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constructor</span>(</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> templateRef<span class="op">:</span> TemplateRef<span class="op">&lt;</span><span class="dt">any</span><span class="op">&gt;,</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> viewContainer<span class="op">:</span> ViewContainerRef<span class="op">,</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> featureFlagService<span class="op">:</span> FeatureFlagService<span class="op">,</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> destroyRef<span class="op">:</span> DestroyRef</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  ) {}</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Usage in Templates:</strong></p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Show component only when feature is enabled --&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> *pemFeatureFlag</span><span class="op">=</span><span class="st">&quot;&#39;PEM.Modeling.ContractComparison&#39;&quot;</span><span class="dt">&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">app-contract-comparison</span><span class="dt">&gt;&lt;/</span><span class="kw">app-contract-comparison</span><span class="dt">&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Navigation items --&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">mat-nav-list</span><span class="dt">&gt;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> mat-list-item routerLink</span><span class="op">=</span><span class="st">&quot;/episodes&quot;</span><span class="dt">&gt;</span>Episodes<span class="dt">&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> mat-list-item routerLink</span><span class="op">=</span><span class="st">&quot;/worklist&quot;</span><span class="dt">&gt;</span>Worklist<span class="dt">&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> mat-list-item routerLink</span><span class="op">=</span><span class="st">&quot;/modeling&quot;</span><span class="ot"> *pemFeatureFlag</span><span class="op">=</span><span class="st">&quot;&#39;PEM.Modeling.Enabled&#39;&quot;</span><span class="dt">&gt;</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    Modeling</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">mat-nav-list</span><span class="dt">&gt;</span></span></code></pre></div>
<p><strong>Route Guards:</strong></p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">// feature-flag.guard.ts</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="kw">const</span> featureFlagGuard <span class="op">=</span> (featureName<span class="op">:</span> <span class="dt">string</span>)<span class="op">:</span> CanActivateFn <span class="kw">=&gt;</span> {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> featureService <span class="op">=</span> <span class="fu">inject</span>(FeatureFlagService)<span class="op">;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> router <span class="op">=</span> <span class="fu">inject</span>(Router)<span class="op">;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> featureService<span class="op">.</span><span class="fu">isEnabled</span>(featureName)<span class="op">.</span><span class="fu">pipe</span>(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map</span>(enabled <span class="kw">=&gt;</span> enabled <span class="op">||</span> router<span class="op">.</span><span class="fu">createUrlTree</span>([<span class="st">&#39;/not-available&#39;</span>]))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">// Usage in routes</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> routes<span class="op">:</span> Routes <span class="op">=</span> [</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    path<span class="op">:</span> <span class="st">&#39;modeling&#39;</span><span class="op">,</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    loadChildren<span class="op">:</span> () <span class="kw">=&gt;</span> <span class="im">import</span>(<span class="st">&#39;./modeling/modeling.module&#39;</span>)<span class="op">,</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    canActivate<span class="op">:</span> [<span class="fu">featureFlagGuard</span>(<span class="st">&#39;PEM.Modeling.Enabled&#39;</span>)]</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>]<span class="op">;</span></span></code></pre></div>
<h4 id="feature-flag-rollout-strategies">Feature Flag Rollout
Strategies</h4>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 61%" />
</colgroup>
<thead>
<tr>
<th>Strategy</th>
<th>Use Case</th>
<th>Azure App Configuration Support</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>On/Off</strong></td>
<td>Simple feature toggle</td>
<td>âœ… Built-in</td>
</tr>
<tr>
<td><strong>Percentage Rollout</strong></td>
<td>Gradual rollout (e.g., 10% â†’ 50% â†’ 100%)</td>
<td>âœ… Built-in (Percentile filter)</td>
</tr>
<tr>
<td><strong>User/Group Targeting</strong></td>
<td>Beta users, specific tenants</td>
<td>âœ… Built-in (Targeting filter)</td>
</tr>
<tr>
<td><strong>Time Window</strong></td>
<td>Scheduled release</td>
<td>âœ… Built-in (Time window filter)</td>
</tr>
</tbody>
</table>
<p><strong>Example: Gradual Rollout Configuration (Azure Portal /
Terraform):</strong></p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;PEM.Modeling.ContractComparison&quot;</span><span class="fu">,</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;enabled&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;conditions&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;client_filters&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Microsoft.Percentage&quot;</span><span class="fu">,</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;parameters&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;Value&quot;</span><span class="fu">:</span> <span class="dv">25</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h4 id="release-workflow">Release Workflow</h4>
<p><strong>Feature Flag Lifecycle</strong></p>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr>
<th>Stage</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1. DEVELOPMENT</strong></td>
<td>Developer creates feature behind flag (Flag = OFF)</td>
</tr>
<tr>
<td><strong>2. DEV/QAE TESTING</strong></td>
<td>QA enables flag in dev/qae (Flag = true for dev/qae)</td>
</tr>
<tr>
<td><strong>3. UAT VALIDATION</strong></td>
<td>Product Owner enables in UAT (Flag = true for uat)</td>
</tr>
<tr>
<td><strong>4. PRODUCTION RELEASE</strong></td>
<td>Options: 10% rollout, Specific tenants, or 100% release</td>
</tr>
<tr>
<td><strong>5. FLAG CLEANUP</strong></td>
<td>Engineering removes flag, feature becomes permanent</td>
</tr>
</tbody>
</table>
<h4 id="governance-and-access-control">Governance and Access
Control</h4>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 37%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr>
<th>Role</th>
<th>Permissions</th>
<th>Responsibility</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Developers</strong></td>
<td>Create flags (dev/qae only)</td>
<td>Add flags for new features</td>
</tr>
<tr>
<td><strong>QA Team</strong></td>
<td>Toggle flags (dev/qae)</td>
<td>Enable for testing</td>
</tr>
<tr>
<td><strong>Product Owners</strong></td>
<td>Toggle flags (all environments)</td>
<td>Control feature releases</td>
</tr>
<tr>
<td><strong>Release Managers</strong></td>
<td>Toggle flags (uat/prod)</td>
<td>Coordinate production rollouts</td>
</tr>
<tr>
<td><strong>Ops/SRE</strong></td>
<td>Emergency kill switch (prod)</td>
<td>Disable features causing issues</td>
</tr>
</tbody>
</table>
<p><strong>Azure RBAC for App Configuration:</strong></p>
<pre class="hcl"><code># Terraform - Role assignments
resource &quot;azurerm_role_assignment&quot; &quot;developers_nonprod&quot; {
  scope                = azurerm_app_configuration.nonprod.id
  role_definition_name = &quot;App Configuration Data Owner&quot;
  principal_id         = data.azuread_group.developers.object_id
}

resource &quot;azurerm_role_assignment&quot; &quot;product_owners_all&quot; {
  for_each             = toset([&quot;nonprod&quot;, &quot;uat&quot;, &quot;prod&quot;])
  scope                = azurerm_app_configuration[each.key].id
  role_definition_name = &quot;App Configuration Data Owner&quot;
  principal_id         = data.azuread_group.product_owners.object_id
}

resource &quot;azurerm_role_assignment&quot; &quot;sre_prod_emergency&quot; {
  scope                = azurerm_app_configuration.prod.id
  role_definition_name = &quot;App Configuration Data Owner&quot;
  principal_id         = data.azuread_group.sre_team.object_id
}</code></pre>
<h4 id="feature-flag-api-endpoint">Feature Flag API Endpoint</h4>
<p>A dedicated API exposes feature flags to the Angular frontend:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode csharp"><code class="sourceCode cs"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">// PEM.Api.Gateway/Endpoints/FeaturesEndpoint.cs</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">static</span> <span class="kw">class</span> FeaturesEndpoint</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">MapFeatureEndpoints</span><span class="op">(</span><span class="kw">this</span> IEndpointRouteBuilder app<span class="op">)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        app<span class="op">.</span><span class="fu">MapGet</span><span class="op">(</span><span class="st">&quot;/api/features&quot;</span><span class="op">,</span> <span class="fu">async</span> <span class="op">(</span>IFeatureManager featureManager<span class="op">)</span> <span class="op">=&gt;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> flags <span class="op">=</span> <span class="kw">new</span> Dictionary<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">bool</span><span class="op">&gt;();</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Enumerate all PEM features</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>            await <span class="kw">foreach</span> <span class="op">(</span><span class="dt">var</span> featureName <span class="kw">in</span> featureManager<span class="op">.</span><span class="fu">GetFeatureNamesAsync</span><span class="op">())</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> <span class="op">(</span>featureName<span class="op">.</span><span class="fu">StartsWith</span><span class="op">(</span><span class="st">&quot;PEM.&quot;</span><span class="op">))</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>                    flags<span class="op">[</span>featureName<span class="op">]</span> <span class="op">=</span> await featureManager<span class="op">.</span><span class="fu">IsEnabledAsync</span><span class="op">(</span>featureName<span class="op">);</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Results<span class="op">.</span><span class="fu">Ok</span><span class="op">(</span>flags<span class="op">);</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">})</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">RequireAuthorization</span><span class="op">()</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">CacheOutput</span><span class="op">(</span>policy <span class="op">=&gt;</span> policy<span class="op">.</span><span class="fu">Expire</span><span class="op">(</span>TimeSpan<span class="op">.</span><span class="fu">FromSeconds</span><span class="op">(</span><span class="dv">30</span><span class="op">)));</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 id="shared-library-management">Shared Library Management</h3>
<p>The <code>@gazelle/ng-common</code> libraries are managed
separately:</p>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    subgraph OPTIONA[&quot;Option A: NPM Package (Recommended)&quot;]
        direction LR
        LIB[&quot;lib-gazelle-angular repo&quot;] --&gt; NPM[&quot;NPM Registry&lt;br/&gt;(private)&quot;]
        NPM --&gt; AZPEM[&quot;azure-pem frontend&quot;]
        NPM --&gt; CM[&quot;contract-manager&quot;]
    end</code></pre>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    subgraph OPTIONB[&quot;Option B: Git Submodule&quot;]
        REPO[&quot;azure-pem&quot;]
        REPO --&gt; LIB2[&quot;â”œâ”€â”€ lib/&quot;]
        LIB2 --&gt; GAZ[&quot;â”‚   â””â”€â”€ gazelle/ â—„â”€â”€ git submodule&quot;]
        REPO --&gt; SRC[&quot;â””â”€â”€ src/&quot;]
    end</code></pre>
<p><strong>Recommendation:</strong> Use <strong>NPM private
registry</strong> for Gazelle libraries to maintain loose coupling.</p>
<h3 id="example-cicd-workflows">Example CI/CD Workflows</h3>
<p><strong>Backend CI (.github/workflows/ci-backend.yml) - With Quality
Gates:</strong></p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Backend CI</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">paths</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&#39;src/backend/**&#39;</span><span class="kw">,</span><span class="at"> </span><span class="st">&#39;tests/backend/**&#39;</span><span class="kw">]</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pull_request</span><span class="kw">:</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">paths</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&#39;src/backend/**&#39;</span><span class="kw">,</span><span class="at"> </span><span class="st">&#39;tests/backend/**&#39;</span><span class="kw">]</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">COVERAGE_THRESHOLD</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span><span class="co">  # 100% code coverage required</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">build-and-test</span><span class="kw">:</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v4</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-dotnet@v4</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">dotnet-version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;10.0.x&#39;</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Restore</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> dotnet restore src/backend/PEM.sln</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Build</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> dotnet build src/backend/PEM.sln --no-restore -c Release</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="co">      # QUALITY GATE: Unit Tests with Code Coverage</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Run Unit Tests with Coverage</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>          dotnet test tests/backend/**/*.Tests.csproj \</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>            --no-build -c Release \</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>            --collect:&quot;XPlat Code Coverage&quot; \</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>            --results-directory ./coverage \</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>            -- DataCollectionRunSettings.DataCollectors.DataCollector.Configuration.Format=opencover</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install ReportGenerator</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> dotnet tool install -g dotnet-reportgenerator-globaltool</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Generate Coverage Report</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>          reportgenerator \</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>            -reports:./coverage/**/coverage.opencover.xml \</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>            -targetdir:./coverage/report \</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>            -reporttypes:Cobertura</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a><span class="co">      # QUALITY GATE: Enforce 100% Code Coverage</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a><span class="co">      # Pipeline FAILS if coverage is below threshold</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Check Code Coverage Threshold</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> irongut/CodeCoverageSummary@v1.3.0</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">filename</span><span class="kw">:</span><span class="at"> ./coverage/report/Cobertura.xml</span></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">badge</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">fail_below_min</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span><span class="co">           # FAIL if below threshold</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">format</span><span class="kw">:</span><span class="at"> markdown</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">output</span><span class="kw">:</span><span class="at"> both</span></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">thresholds</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;100 100&#39;</span><span class="co">          # 100% line, 100% branch coverage</span></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Add Coverage PR Comment</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> marocchino/sticky-pull-request-comment@v2</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">if</span><span class="kw">:</span><span class="at"> github.event_name == &#39;pull_request&#39;</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">recreate</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">path</span><span class="kw">:</span><span class="at"> code-coverage-results.md</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a><span class="co">      # QUALITY GATE: Integration Tests</span></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Run Integration Tests</span></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>          dotnet test tests/backend/**/*.IntegrationTests.csproj \</span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>            --no-build -c Release</span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a><span class="co">      # QUALITY GATE: Security Scan (SAST)</span></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Security Scan</span></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> github/codeql-action/analyze@v2</span></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">languages</span><span class="kw">:</span><span class="at"> csharp</span></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Dependency Vulnerability Scan</span></span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> dotnet list src/backend/PEM.sln package --vulnerable --include-transitive</span></span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a><span class="co">      # Only publish artifacts if ALL quality gates pass</span></span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Publish artifacts</span></span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">if</span><span class="kw">:</span><span class="at"> success()</span></span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/upload-artifact@v4</span></span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">name</span><span class="kw">:</span><span class="at"> backend-artifacts</span></span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">path</span><span class="kw">:</span><span class="at"> src/backend/**/bin/Release/net8.0/publish/</span></span></code></pre></div>
<p><strong>Frontend CI (.github/workflows/ci-frontend.yml) - With
Quality Gates:</strong></p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Frontend CI</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">paths</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&#39;src/frontend/**&#39;</span><span class="kw">]</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pull_request</span><span class="kw">:</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">paths</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&#39;src/frontend/**&#39;</span><span class="kw">]</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">COVERAGE_THRESHOLD</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span><span class="co">  # 100% code coverage required</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">build-and-test</span><span class="kw">:</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">defaults</span><span class="kw">:</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">run</span><span class="kw">:</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">working-directory</span><span class="kw">:</span><span class="at"> src/frontend</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v4</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-node@v4</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">node-version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;20&#39;</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">cache</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;npm&#39;</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">cache-dependency-path</span><span class="kw">:</span><span class="at"> src/frontend/package-lock.json</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npm ci</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="co">      # QUALITY GATE: Linting</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Lint Check</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npm run lint</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="co">      # QUALITY GATE: Unit Tests with 100% Code Coverage</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Run Tests with Coverage</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>          npm run test -- \</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>            --watch=false \</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>            --browsers=ChromeHeadless \</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>            --code-coverage</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Check Coverage Threshold</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>          # karma.conf.js must have coverageReporter with check thresholds:</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>          # check: {</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>          #   global: { statements: 100, branches: 100, functions: 100, lines: 100 }</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>          # }</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>          # If coverage is below 100%, the test command will fail automatically</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>          echo &quot;âœ… Code coverage meets 100% threshold&quot;</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a><span class="co">      # QUALITY GATE: Security Scan</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Dependency Audit</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npm audit --audit-level=high</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">continue-on-error</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span><span class="co">  # Fail on high/critical vulnerabilities</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a><span class="co">      # Build (only if all quality gates pass)</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a><span class="co">      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Build Production</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npm run build -- --configuration=production</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/upload-artifact@v4</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">if</span><span class="kw">:</span><span class="at"> success()</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">name</span><span class="kw">:</span><span class="at"> frontend-dist</span></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">path</span><span class="kw">:</span><span class="at"> src/frontend/dist/</span></span></code></pre></div>
<p><strong>Angular Karma Configuration for 100% Coverage
(karma.conf.js):</strong></p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> <span class="kw">function</span> (config) {</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  config<span class="op">.</span><span class="fu">set</span>({</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... other config ...</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">coverageReporter</span><span class="op">:</span> {</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">dir</span><span class="op">:</span> <span class="pp">require</span>(<span class="st">&#39;path&#39;</span>)<span class="op">.</span><span class="fu">join</span>(<span class="bu">__dirname</span><span class="op">,</span> <span class="st">&#39;./coverage&#39;</span>)<span class="op">,</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">subdir</span><span class="op">:</span> <span class="st">&#39;.&#39;</span><span class="op">,</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reporters</span><span class="op">:</span> [</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>        { <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;html&#39;</span> }<span class="op">,</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        { <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;lcov&#39;</span> }<span class="op">,</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        { <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;text-summary&#39;</span> }</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>      ]<span class="op">,</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>      <span class="co">// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>      <span class="co">// QUALITY GATE: Enforce 100% coverage - tests FAIL if not met</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>      <span class="co">// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">check</span><span class="op">:</span> {</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">global</span><span class="op">:</span> {</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>          <span class="dt">statements</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>          <span class="dt">branches</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>          <span class="dt">functions</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>          <span class="dt">lines</span><span class="op">:</span> <span class="dv">100</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p><strong>Infrastructure CD
(.github/workflows/cd-infrastructure.yml):</strong></p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Infrastructure CD</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">workflow_dispatch</span><span class="kw">:</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;Target environment&#39;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> choice</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">options</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">dev</span><span class="kw">,</span><span class="at"> qae</span><span class="kw">,</span><span class="at"> uat</span><span class="kw">,</span><span class="at"> prod</span><span class="kw">]</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">terraform</span><span class="kw">:</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span><span class="at"> ${{ inputs.environment }}</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v4</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> hashicorp/setup-terraform@v3</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Terraform Init</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">working-directory</span><span class="kw">:</span><span class="at"> infrastructure/terraform</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> terraform init -backend-config=&quot;key=${{ inputs.environment }}.tfstate&quot;</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Terraform Plan</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">working-directory</span><span class="kw">:</span><span class="at"> infrastructure/terraform</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> terraform plan -var-file=&quot;environments/${{ inputs.environment }}.tfvars&quot;</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Terraform Apply</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">if</span><span class="kw">:</span><span class="at"> github.ref == &#39;refs/heads/main&#39;</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">working-directory</span><span class="kw">:</span><span class="at"> infrastructure/terraform</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> terraform apply -auto-approve -var-file=&quot;environments/${{ inputs.environment }}.tfvars&quot;</span></span></code></pre></div>
<h3 id="isolation-benefits">Isolation Benefits</h3>
<table>
<colgroup>
<col style="width: 47%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th>Aspect</th>
<th>Benefit</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Independent Releases</strong></td>
<td>Deploy PEM without touching Contract Manager</td>
</tr>
<tr>
<td><strong>Separate Versioning</strong></td>
<td>PEM version evolves independently</td>
</tr>
<tr>
<td><strong>Isolated Failures</strong></td>
<td>PEM issues donâ€™t block CM releases</td>
</tr>
<tr>
<td><strong>Team Autonomy</strong></td>
<td>PEM team owns full pipeline</td>
</tr>
<tr>
<td><strong>Clean Dependencies</strong></td>
<td>Only PEM.Client SDK shared with CM</td>
</tr>
<tr>
<td><strong>Faster CI</strong></td>
<td>Smaller repo = faster builds</td>
</tr>
<tr>
<td><strong>Clear Ownership</strong></td>
<td>Single team responsible for azure-pem</td>
</tr>
</tbody>
</table>
<h3 id="net-solution-projects">.NET Solution Projects</h3>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 25%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr>
<th>Project</th>
<th>Type</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>PEM.Domain</code></td>
<td>Class Library</td>
<td>Entities, value objects, domain logic</td>
</tr>
<tr>
<td><code>PEM.Application</code></td>
<td>Class Library</td>
<td>Use cases, DTOs, interfaces</td>
</tr>
<tr>
<td><code>PEM.Infrastructure</code></td>
<td>Class Library</td>
<td>EF Core, Azure SDK, external APIs</td>
</tr>
<tr>
<td><code>PEM.Api.Episodes</code></td>
<td>.NET 10 Minimal API</td>
<td>Episode CRUD, search, status</td>
</tr>
<tr>
<td><code>PEM.Api.Definitions</code></td>
<td>.NET 10 Minimal API</td>
<td>Definition management</td>
</tr>
<tr>
<td><code>PEM.Api.Modeling</code></td>
<td>.NET 10 Minimal API</td>
<td>Contract-based modeling, what-if scenarios</td>
</tr>
<tr>
<td><code>PEM.Api.Reporting</code></td>
<td>.NET 10 Minimal API</td>
<td>Reports, analytics, exports</td>
</tr>
<tr>
<td><code>PEM.Api.Worklist</code></td>
<td>.NET 10 Minimal API</td>
<td>Saved worklists, user preferences</td>
</tr>
<tr>
<td><code>PEM.Workers</code></td>
<td>Azure Functions</td>
<td>Background processing, scenario calculation</td>
</tr>
<tr>
<td><code>PEM.Client</code></td>
<td>Class Library</td>
<td>API client SDK for Contract Manager integration</td>
</tr>
</tbody>
</table>
<h3 id="angular-frontend-module-in-contract-manager">Angular Frontend
(Module in Contract Manager)</h3>
<blockquote>
<p><strong>Important:</strong> The PEM frontend is <strong>NOT a
separate Angular application</strong>. It is a <strong>new module within
the existing Contract Manager Angular app</strong>
(<code>app-cm-web-app/cm-web-app</code>). This means: - PEM UI deploys
with Contract Manager, not separately to Azure - PEM reuses CMâ€™s
authentication, navigation, and shared services - PEM follows all
existing CM Angular patterns and conventions</p>
</blockquote>
<p><strong>PEM Module Structure</strong> (added to
<code>contract-manager/app-cm-web-app/cm-web-app/projects/cm-web-app/src/app/pem/</code>):</p>
<table>
<colgroup>
<col style="width: 38%" />
<col style="width: 61%" />
</colgroup>
<thead>
<tr>
<th>Module</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pem/</code></td>
<td>Root PEM module with routing</td>
</tr>
<tr>
<td><code>pem/pem-worklist/</code></td>
<td>PEM-specific worklist (extends CM worklist patterns)</td>
</tr>
<tr>
<td><code>pem/episodes/</code></td>
<td>Episode list, detail, search, status management</td>
</tr>
<tr>
<td><code>pem/definitions/</code></td>
<td>Definition builder with trigger/association rules</td>
</tr>
<tr>
<td><code>pem/modeling/</code></td>
<td>Contract comparison, what-if scenarios</td>
</tr>
<tr>
<td><code>pem/reports/</code></td>
<td>Dashboard, reports, exports</td>
</tr>
<tr>
<td><code>pem/shared/</code></td>
<td>PEM-specific components, <code>pem-api.service.ts</code>,
<code>pem-signalr.service.ts</code></td>
</tr>
</tbody>
</table>
<p><strong>Contract Manager Angular Standards (align exactly with
<code>app-cm-web-app</code>):</strong></p>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 30%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr>
<th>Pattern</th>
<th>Implementation</th>
<th>Contract Manager Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Angular Version</strong></td>
<td>Angular 19+</td>
<td>See <code>app-cm-web-app/cm-web-app/package.json</code></td>
</tr>
<tr>
<td><strong>Libraries</strong></td>
<td><code>@gazelle/ng-common</code>,
<code>@gazelle/ng-common-auth</code>,
<code>@gazelle/ng-common-ui</code></td>
<td>Core shared libraries</td>
</tr>
<tr>
<td><strong>UI Framework</strong></td>
<td>Angular Material 19+ with CDK</td>
<td><code>@angular/material</code>, <code>@angular/cdk</code></td>
</tr>
<tr>
<td><strong>Date Handling</strong></td>
<td>Luxon (not moment.js)</td>
<td><code>@angular/material-luxon-adapter</code></td>
</tr>
<tr>
<td><strong>State Management</strong></td>
<td>Store classes with BehaviorSubject</td>
<td>e.g., <code>WorklistCriteriaStore</code>,
<code>ContractModelsStore</code></td>
</tr>
<tr>
<td><strong>Change Detection</strong></td>
<td><code>ChangeDetectionStrategy.OnPush</code></td>
<td>All components</td>
</tr>
<tr>
<td><strong>Subscriptions</strong></td>
<td><code>SubscriberBase</code> pattern with
<code>takeUntil(destroyed$)</code></td>
<td>Prevent memory leaks</td>
</tr>
<tr>
<td><strong>Forms</strong></td>
<td>Reactive Forms with async validators</td>
<td><code>ReactiveFormsModule</code></td>
</tr>
<tr>
<td><strong>Data Sources</strong></td>
<td><code>AdvancedDataSource</code> with virtual scrolling</td>
<td>From <code>@gazelle/ng-common-ui</code></td>
</tr>
<tr>
<td><strong>Dialogs</strong></td>
<td>CDK Dialog (<code>@angular/cdk/dialog</code>)</td>
<td>Not MatDialog</td>
</tr>
<tr>
<td><strong>Logging</strong></td>
<td><code>ConsoleLoggerService</code> via
<code>LogServiceFactory</code></td>
<td><code>ILOGGER_INJECTION_TOKEN</code></td>
</tr>
<tr>
<td><strong>Authentication</strong></td>
<td><code>AuthService</code> from
<code>@gazelle/ng-common-auth</code></td>
<td>OIDC with <code>oidc-client-ts</code></td>
</tr>
<tr>
<td><strong>HTTP</strong></td>
<td><code>provideHttpClient</code> with
<code>BaseUrlInterceptorService</code></td>
<td>Token injection via interceptors</td>
</tr>
<tr>
<td><strong>Path Aliases</strong></td>
<td><code>@/</code> maps to <code>src/app/</code></td>
<td>See <code>tsconfig.json</code></td>
</tr>
<tr>
<td><strong>Styling</strong></td>
<td>SCSS with abstracts/base/components/vendors</td>
<td>See <code>sass/</code> directory</td>
</tr>
<tr>
<td><strong>Lazy Loading</strong></td>
<td>Feature modules lazy-loaded via router</td>
<td>e.g., <code>WorklistModule</code></td>
</tr>
<tr>
<td><strong>Guards</strong></td>
<td>Functional guards (e.g., <code>permissionGuard</code>)</td>
<td>In <code>shared/guards/</code></td>
</tr>
<tr>
<td><strong>Route Data</strong></td>
<td><code>helpId</code>, <code>viewTitle</code>, <code>backLink</code>,
<code>requiredPermissions</code></td>
<td>Standard route metadata</td>
</tr>
</tbody>
</table>
<p><strong>Directory Structure Conventions (from Contract
Manager):</strong></p>
<table>
<colgroup>
<col style="width: 48%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th>Convention</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Feature modules have their own routing module</td>
<td>e.g., <code>worklist-routing.module.ts</code></td>
</tr>
<tr>
<td>Sub-components in subdirectories</td>
<td>e.g., <code>worklist/worklist-criteria/</code></td>
</tr>
<tr>
<td>Stores alongside their feature</td>
<td>e.g., <code>worklist-criteria/worklist-criteria-store.ts</code></td>
</tr>
<tr>
<td>API services end with <code>-api</code> or
<code>-api.service</code></td>
<td>e.g., <code>bill-search-api.service.ts</code></td>
</tr>
<tr>
<td>Enums in separate files</td>
<td>e.g., <code>date-type.enum.ts</code>,
<code>patient-type.enum.ts</code></td>
</tr>
<tr>
<td>Models in separate <code>.model.ts</code> files</td>
<td>e.g., <code>bill.model.ts</code>,
<code>grid-bill.model.ts</code></td>
</tr>
<tr>
<td>Index files (<code>index.ts</code>) for barrel exports</td>
<td>Simplifies imports</td>
</tr>
<tr>
<td>Spec files alongside source files</td>
<td>e.g., <code>worklist.service.spec.ts</code></td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> The PEM frontend is a module within the
existing Contract Manager Angular app. It is NOT deployed separately to
Azure. The <code>PEM.Client</code> SDK enables the CM backend to
communicate with Azure PEM APIs, while the Angular module provides the
UI within CM.</p>
<hr />
<h2 id="core-features-from-pem-specification">Core Features (From PEM
Specification)</h2>
<h3 id="episode-definition-management">Episode Definition
Management</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td>Create Definition</td>
<td>Define episode type with rules</td>
<td>P1</td>
</tr>
<tr>
<td>Trigger Rules</td>
<td>Diagnosis/procedure codes that start episode</td>
<td>P1</td>
</tr>
<tr>
<td>Association Rules</td>
<td>Rules for adding claims to episode</td>
<td>P1</td>
</tr>
<tr>
<td>Time Windows</td>
<td>Pre/post-trigger periods</td>
<td>P1</td>
</tr>
<tr>
<td>Phase Configuration</td>
<td>Define episode phases</td>
<td>P2</td>
</tr>
<tr>
<td>Definition Versioning</td>
<td>Effective date management</td>
<td>P1</td>
</tr>
<tr>
<td>Activation Workflow</td>
<td>Draft â†’ Active lifecycle</td>
<td>P1</td>
</tr>
</tbody>
</table>
<h3 id="episode-management">Episode Management</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td>Episode Creation</td>
<td>Auto-create from trigger claims</td>
<td>P1</td>
</tr>
<tr>
<td>Manual Episode</td>
<td>Create episode manually</td>
<td>P2</td>
</tr>
<tr>
<td>Claim Association</td>
<td>Add/remove claims</td>
<td>P1</td>
</tr>
<tr>
<td>Episode Search</td>
<td>Multi-criteria search</td>
<td>P1</td>
</tr>
<tr>
<td>Episode Detail View</td>
<td>View all episode data</td>
<td>P1</td>
</tr>
<tr>
<td>Status Management</td>
<td>Lifecycle state changes</td>
<td>P1</td>
</tr>
<tr>
<td>Phase Tracking</td>
<td>Track claims by phase</td>
<td>P2</td>
</tr>
<tr>
<td>Provider Association</td>
<td>Link providers to episode</td>
<td>P2</td>
</tr>
<tr>
<td>Notes</td>
<td>Add notes to episodes</td>
<td>P2</td>
</tr>
</tbody>
</table>
<h3 id="bundle-calculation">Bundle Calculation</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bundle Pricing</td>
<td>Calculate bundle payment</td>
<td>P1</td>
</tr>
<tr>
<td>Target Price</td>
<td>Compare to target</td>
<td>P1</td>
</tr>
<tr>
<td>Variance</td>
<td>Calculate variance</td>
<td>P1</td>
</tr>
<tr>
<td>Pricing Methods</td>
<td>Multiple calculation methods</td>
<td>P2</td>
</tr>
</tbody>
</table>
<h3 id="contract-based-modeling">Contract-Based Modeling</h3>
<table>
<colgroup>
<col style="width: 28%" />
<col style="width: 40%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td>Contract Profile Selection</td>
<td>Model claims against specific contract</td>
<td>P1</td>
</tr>
<tr>
<td>Contract-Specific Bundling</td>
<td>Same claims grouped differently per contract</td>
<td>P1</td>
</tr>
<tr>
<td>Modeling Scenarios</td>
<td>Create what-if scenarios for contract comparison</td>
<td>P1</td>
</tr>
<tr>
<td>Multi-Contract Comparison</td>
<td>Compare bundling results across contracts</td>
<td>P2</td>
</tr>
<tr>
<td>Scenario Persistence</td>
<td>Save and retrieve modeling scenarios</td>
<td>P2</td>
</tr>
</tbody>
</table>
<h3 id="reporting-analytics">Reporting &amp; Analytics</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td>Episode Dashboard</td>
<td>KPIs, metrics</td>
<td>P1</td>
</tr>
<tr>
<td>Episode Reports</td>
<td>Summary/detail reports</td>
<td>P1</td>
</tr>
<tr>
<td>Export</td>
<td>CSV/Excel export</td>
<td>P2</td>
</tr>
<tr>
<td>Analytics</td>
<td>Trends, patterns</td>
<td>P3</td>
</tr>
</tbody>
</table>
<h3 id="worklist-ui-from-contract-manager-1">Worklist UI (From Contract
Manager)</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td>Episode Worklist</td>
<td>High-performance grid with virtual scroll</td>
<td>P1</td>
</tr>
<tr>
<td>Column Customization</td>
<td>Reorder, resize, show/hide columns</td>
<td>P1</td>
</tr>
<tr>
<td>Advanced Filtering</td>
<td>Criteria builder + in-grid filters</td>
<td>P1</td>
</tr>
<tr>
<td>Saved Worklists</td>
<td>Save/load worklist configurations</td>
<td>P1</td>
</tr>
<tr>
<td>Shared Worklists</td>
<td>Share worklists across team members</td>
<td>P2</td>
</tr>
<tr>
<td>Export with Selection</td>
<td>Export visible/selected columns</td>
<td>P1</td>
</tr>
<tr>
<td>Multi-Mode Support</td>
<td>Production, Audit, Model modes</td>
<td>P1</td>
</tr>
<tr>
<td>Facility Context</td>
<td>Organization/facility-based filtering</td>
<td>P1</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="data-model">Data Model</h2>
<h3 id="core-entities">Core Entities</h3>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
erDiagram
    ContractProfile ||--o{ EpisodeDefinition : contains
    EpisodeDefinition ||--o{ DefinitionVersion : &quot;has versions&quot;
    DefinitionVersion ||--o{ Episode : &quot;creates&quot;
    Episode ||--o{ EpisodeClaim : &quot;includes&quot;
    Episode ||--o{ EpisodePhase : &quot;has phases&quot;
    Episode ||--o{ EpisodeProvider : &quot;has providers&quot;
    Episode ||--o{ EpisodeNote : &quot;has notes&quot;
    ModelingScenario ||--o{ ScenarioComparison : &quot;compares&quot;
    ModelingScenario ||--o{ Episode : &quot;generates&quot;

    ContractProfile {
        guid Id PK
        string ContractId
        string Name
        date EffectiveDate
        date TerminationDate
        json BundlingRulesJson
        guid TenantId
    }

    EpisodeDefinition {
        guid Id PK
        guid ContractProfileId FK
        string Name
        string Description
        string EpisodeClass
        bool IsActive
        guid TenantId
        datetime CreatedAt
    }

    DefinitionVersion {
        guid DefinitionId FK
        int VersionNumber
        date EffectiveDate
        date TerminationDate
        string Status
        json TriggerRulesJson
        json AssociationRulesJson
        json PhasesJson
    }

    Episode {
        guid Id PK
        guid DefinitionVersionId FK
        guid ContractProfileId FK
        guid ModelingScenarioId FK
        guid TenantId
        string PatientId
        string Status
        date TriggerDate
        date StartDate
        date EndDate
        decimal BundleAmount
        decimal TargetPrice
        decimal Variance
        bool IsModelingResult
        datetime CreatedAt
        datetime ModifiedAt
    }

    EpisodeClaim {
        guid EpisodeId FK
        string ClaimId
        bool IsTriggerClaim
        guid PhaseId
        date ClaimDate
        decimal ClaimAmount
        datetime AssociatedAt
    }

    EpisodePhase {
        guid EpisodeId FK
        string Name
        date StartDate
        date EndDate
        decimal TotalAmount
    }

    EpisodeProvider {
        guid EpisodeId FK
        string ProviderId
        string ProviderName
        string Role
        bool IsPrimary
    }

    EpisodeNote {
        guid EpisodeId FK
        string NoteText
        string CreatedBy
        datetime CreatedAt
    }

    ModelingScenario {
        guid Id PK
        string Name
        string Description
        json BaseClaimSetJson
        string PatientId
        date DateRangeStart
        date DateRangeEnd
        string Status
        string CreatedBy
        datetime CreatedAt
        guid TenantId
    }

    ScenarioComparison {
        guid Id PK
        guid ScenarioId FK
        guid ContractProfileId FK
        decimal TotalBundleAmount
        int EpisodeCount
        decimal VarianceFromBase
        json ResultsJson
        datetime CalculatedAt
    }</code></pre>
<h3 id="contract-based-bundling-concept">Contract-Based Bundling
Concept</h3>
<p>Claims can be grouped into different episodes based on the contract
profile being applied:</p>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    subgraph CLAIMS[&quot;Claims Set (Patient X, Jan-Mar 2026)&quot;]
        CA[&quot;Claim A: Surgery (CPT 27447)&quot;]
        CB[&quot;Claim B: Hospital Stay (3 days)&quot;]
        CC[&quot;Claim C: Anesthesia&quot;]
        CD[&quot;Claim D: PT Session 1&quot;]
        CE[&quot;Claim E: PT Session 2&quot;]
        CF[&quot;Claim F: Follow-up Visit&quot;]
    end

    CLAIMS --&gt; CONTRA
    CLAIMS --&gt; CONTRB
    CLAIMS --&gt; CONTRC

    subgraph CONTRA[&quot;CONTRACT A (90-day bundle)&quot;]
        EPA[&quot;Episode 1:&lt;br/&gt;All Claims A-F&lt;br/&gt;Bundle: $28,000&quot;]
    end

    subgraph CONTRB[&quot;CONTRACT B (30-day bundle)&quot;]
        EPB1[&quot;Episode 1:&lt;br/&gt;Claims A-C only&lt;br/&gt;Bundle: $22,000&quot;]
        EPB2[&quot;Episode 2:&lt;br/&gt;Claims D-F&lt;br/&gt;Bundle: $3,500&quot;]
    end

    subgraph CONTRC[&quot;CONTRACT C (Acute only)&quot;]
        EPC[&quot;Episode 1:&lt;br/&gt;Claims A-C only&lt;br/&gt;Bundle: $20,000&lt;br/&gt;(D-F excluded)&quot;]
    end</code></pre>
<h3 id="database-azure-sql">Database: Azure SQL</h3>
<ul>
<li><strong>Primary database</strong> for all episode data</li>
<li>Entity Framework Core 10 for data access</li>
<li>Migrations for schema management</li>
<li>Read replicas for reporting (optional)</li>
</ul>
<hr />
<h2 id="security-identity">Security &amp; Identity</h2>
<h3 id="authentication">Authentication</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Approach</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>User Auth</strong></td>
<td>Azure AD / Entra ID</td>
</tr>
<tr>
<td><strong>API Auth</strong></td>
<td>OAuth 2.0 + JWT Bearer tokens</td>
</tr>
<tr>
<td><strong>Service Auth</strong></td>
<td>Managed Identity</td>
</tr>
<tr>
<td><strong>Secrets</strong></td>
<td>Azure Key Vault</td>
</tr>
</tbody>
</table>
<h3 id="authorization">Authorization</h3>
<table>
<thead>
<tr>
<th>Level</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>API Gateway</strong></td>
<td>API Management policies</td>
</tr>
<tr>
<td><strong>Service Level</strong></td>
<td>JWT claims validation</td>
</tr>
<tr>
<td><strong>Data Level</strong></td>
<td>Tenant isolation (TenantId on all entities)</td>
</tr>
<tr>
<td><strong>Feature Level</strong></td>
<td>Role-based permissions</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="integration-patterns">Integration Patterns</h2>
<h3 id="inbound-data-claims">Inbound Data (Claims)</h3>
<p>Claims data can be ingested via: 1. <strong>REST API</strong> - Push
claims via API 2. <strong>Azure Service Bus</strong> - Event-driven
ingestion 3. <strong>Azure Data Factory</strong> - Batch ETL from source
systems 4. <strong>File Upload</strong> - Blob storage + Azure Function
trigger</p>
<h3 id="outbound-events">Outbound Events</h3>
<p>Episode events published to: 1. <strong>Azure Service Bus
Topics</strong> - For subscribers 2. <strong>Azure Event Grid</strong> -
Webhooks to external systems 3. <strong>API Polling</strong> - Status
check endpoints</p>
<h3 id="integration-with-contract-manager-host-system">Integration with
Contract Manager (Host System)</h3>
<p>Azure PEM operates as a module within the on-premises Contract
Manager system:</p>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    subgraph ONPREM[&quot;ON-PREMISES CONTRACT MANAGER&quot;]
        subgraph CMAPP[&quot;Contract Manager Application&quot;]
            CONTRACTS[&quot;Contracts Module&quot;]
            MODELING[&quot;Modeling Module&quot;]
            PEM[&quot;PEM Module&lt;br/&gt;(Azure-backed)&quot;]
        end
        CLAIMSHOP[&quot;Claims Data (ClaimShop)&quot;]
    end

    subgraph AZURE[&quot;AZURE (Cloud Backend)&quot;]
        APIM[&quot;API Management&lt;br/&gt;(Gateway)&quot;]
        APIS[&quot;Episode APIs&lt;br/&gt;(.NET 10)&quot;]
        FUNC[&quot;Azure Functions&lt;br/&gt;(Workers)&quot;]
        SQL[&quot;Azure SQL&lt;br/&gt;(Episode Data)&quot;]
        SB[&quot;Service Bus&lt;br/&gt;(Messaging)&quot;]
        BLOB[&quot;Blob Storage&lt;br/&gt;(Documents)&quot;]
    end

    PEM &lt;--&gt;|&quot;HTTPS/API&quot;| APIM
    APIM --&gt; APIS
    APIM --&gt; FUNC
    APIS --&gt; SQL
    APIS --&gt; SB
    FUNC --&gt; BLOB</code></pre>
<p><strong>Key Integration Points:</strong> - Contract Manager UI hosts
the PEM module interface - Contract Manager authenticates users; Azure
PEM validates tokens - Claims data flows from ClaimShop through Contract
Manager to Azure - Azure PEM APIs are consumed by Contract Manager (not
directly by end users)</p>
<hr />
<h2 id="environments">Environments</h2>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 12%" />
<col style="width: 26%" />
<col style="width: 20%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr>
<th>Environment</th>
<th>Purpose</th>
<th>Azure Subscription</th>
<th>Accessibility</th>
<th>Shared Services</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>dev</strong></td>
<td>Development/testing</td>
<td>Non-prod</td>
<td>Internal only</td>
<td>Shared with QAE</td>
</tr>
<tr>
<td><strong>qae</strong></td>
<td>QA/Engineering testing</td>
<td>Non-prod</td>
<td>Internal only</td>
<td>Shared with Dev</td>
</tr>
<tr>
<td><strong>uat</strong></td>
<td>User Acceptance Testing</td>
<td>Non-prod</td>
<td><strong>Publicly accessible</strong></td>
<td>Isolated</td>
</tr>
<tr>
<td><strong>prod</strong></td>
<td>Production</td>
<td>Production</td>
<td><strong>Publicly accessible</strong></td>
<td>Isolated</td>
</tr>
</tbody>
</table>
<h3 id="shared-services-architecture">Shared Services Architecture</h3>
<p><strong>Shared Services Architecture</strong></p>
<pre class="mermaid"><code>%%{init: {&#39;theme&#39;: &#39;default&#39;}}%%
flowchart TB
    subgraph NONPROD[&quot;NON-PROD SUBSCRIPTION&quot;]
        subgraph SHARED[&quot;rg-pem-shared-nonprod (Shared Services)&quot;]
            SB_NP[&quot;Service Bus&quot;]
            SQL_NP[&quot;SQL Server&lt;br/&gt;â”œâ”€pem-db-dev&lt;br/&gt;â””â”€pem-db-qae&quot;]
            REDIS_NP[&quot;Redis Cache&quot;]
            SIGNALR_NP[&quot;SignalR&quot;]
            KV_NP[&quot;Key Vault&quot;]
            CONFIG_NP[&quot;App Config + LA&quot;]
        end

        subgraph DEV[&quot;rg-pem-dev&quot;]
            DEV_COMPUTE[&quot;App Service Plan, APIs&lt;br/&gt;Functions, Static Web&quot;]
        end

        subgraph QAE[&quot;rg-pem-qae&quot;]
            QAE_COMPUTE[&quot;App Service Plan, APIs&lt;br/&gt;Functions, Static Web&quot;]
        end

        subgraph UAT[&quot;rg-pem-uat (Isolated)&quot;]
            UAT_ALL[&quot;Own: SB, SQL, Redis, SignalR,&lt;br/&gt;KV, App Svc, Func, SWA&quot;]
        end

        DEV --&gt; SHARED
        QAE --&gt; SHARED
    end

    subgraph PRODSUB[&quot;PROD SUBSCRIPTION (Zone-Redundant)&quot;]
        subgraph PRODENV[&quot;rg-pem-prod (Isolated)&quot;]
            PROD_ALL[&quot;Own: SB Premium, SQL BC, Redis Premium,&lt;br/&gt;SignalR 5u, App Svc Premium, Func Premium, SWA&quot;]
        end
    end</code></pre>
<p><strong>Shared vs Isolated Resources:</strong></p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 30%" />
<col style="width: 16%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr>
<th>Resource</th>
<th>Dev/QAE</th>
<th>UAT</th>
<th>Prod</th>
</tr>
</thead>
<tbody>
<tr>
<td>Service Bus</td>
<td>Shared (1 namespace)</td>
<td>Own</td>
<td>Own</td>
</tr>
<tr>
<td>SQL Server</td>
<td>Shared (separate DBs)</td>
<td>Own</td>
<td>Own</td>
</tr>
<tr>
<td>Redis Cache</td>
<td>Shared</td>
<td>Own</td>
<td>Own</td>
</tr>
<tr>
<td>SignalR Service</td>
<td>Shared</td>
<td>Own</td>
<td>Own</td>
</tr>
<tr>
<td>Key Vault</td>
<td>Shared</td>
<td>Own</td>
<td>Own</td>
</tr>
<tr>
<td>App Configuration</td>
<td>Shared (feature flags)</td>
<td>Own</td>
<td>Own</td>
</tr>
<tr>
<td>App Insights</td>
<td>Shared</td>
<td>Own</td>
<td>Own</td>
</tr>
<tr>
<td>App Services</td>
<td>Separate per env</td>
<td>Own</td>
<td>Own</td>
</tr>
<tr>
<td>Function Apps</td>
<td>Separate per env</td>
<td>Own</td>
<td>Own</td>
</tr>
<tr>
<td><strong>PEM UI</strong></td>
<td><strong>Deployed with Contract Manager (on-prem)</strong></td>
<td><strong>CM</strong></td>
<td><strong>CM</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="success-criteria">Success Criteria</h2>
<h3 id="phase-1-core-platform-eoy-2026">Phase 1: Core Platform (EOY
2026)</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Azure infrastructure deployed
(Terraform)</label></li>
<li><label><input type="checkbox" />Episode Definition API
operational</label></li>
<li><label><input type="checkbox" />Episode Management API
operational</label></li>
<li><label><input type="checkbox" />Episode creation from trigger
claims</label></li>
<li><label><input type="checkbox" />Claim association
working</label></li>
<li><label><input type="checkbox" />Bundle calculation
functional</label></li>
<li><label><input type="checkbox" /><strong>Contract-based modeling
operational</strong></label></li>
<li><label><input type="checkbox" /><strong>Multi-contract bundling
comparison available</strong></label></li>
<li><label><input type="checkbox" /><strong>Worklist UI (Contract
Manager patterns) operational</strong></label></li>
<li><label><input type="checkbox" /><strong>Saved worklists and export
features working</strong></label></li>
<li><label><input type="checkbox" /><strong>PEM module integrated into
Contract Manager Angular app</strong></label></li>
<li><label><input type="checkbox" /><strong>PEM.Client SDK available for
Contract Manager integration</strong></label></li>
<li><label><input type="checkbox" />Authentication via Azure
AD</label></li>
<li><label><input type="checkbox" />Claims ingestion from Contract
Manager/ClaimShop working</label></li>
<li><label><input type="checkbox" />Production deployment
complete</label></li>
</ul>
<h3 id="phase-2-enhanced-features-2027">Phase 2: Enhanced Features
(2027)</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Advanced episode
modeling</label></li>
<li><label><input type="checkbox" />What-if analysis</label></li>
<li><label><input type="checkbox" />Enhanced
analytics/reporting</label></li>
<li><label><input type="checkbox" />External integrations</label></li>
<li><label><input type="checkbox" />Performance
optimization</label></li>
</ul>
<hr />
<h2 id="related-documents">Related Documents</h2>
<h3 id="existing-documentation">Existing Documentation</h3>
<ul>
<li><a href="02-AZURE-ARCHITECTURE.html">02-AZURE-ARCHITECTURE.md</a> -
Detailed Azure architecture, services, and design patterns</li>
<li><a
href="03-PEM-FEATURE-SPECIFICATION.html">03-PEM-FEATURE-SPECIFICATION.md</a>
- Feature specifications, requirements, and acceptance criteria</li>
</ul>
<h3 id="additional-documentation">Additional Documentation</h3>
<ul>
<li><a href="04-DATA-MODEL.html">04-DATA-MODEL.md</a> - Complete data
model, entity relationships, database schema</li>
<li><a href="05-API-DESIGN.html">05-API-DESIGN.md</a> - API
specifications, endpoints, request/response formats</li>
<li><a href="06-INFRASTRUCTURE.html">06-INFRASTRUCTURE.md</a> -
Terraform modules, deployment scripts, environment setup</li>
<li><a href="07-DEVELOPMENT-GUIDE.html">07-DEVELOPMENT-GUIDE.md</a> -
Developer setup, local environment, coding standards</li>
<li><a href="08-TESTING-STRATEGY.html">08-TESTING-STRATEGY.md</a> - Test
approach, coverage requirements, test automation</li>
<li><a
href="09-BUNDLE-CALCULATION-SPECIFICATION.html">09-BUNDLE-CALCULATION-SPECIFICATION.md</a>
- Bundle calculation rules engine, pricing configuration, edge cases,
audit trails</li>
<li><a
href="10-SECURITY-AND-COMPLIANCE.html">10-SECURITY-AND-COMPLIANCE.md</a>
- HIPAA compliance, PHI handling, encryption, audit logging, incident
response</li>
</ul>
<hr />
<p><strong>Document Status:</strong> âœ… <strong>Initial Version
Complete</strong><br />
<strong>Next Steps:</strong> Review with stakeholders, begin Azure
architecture design</p>
</body>
</html>
